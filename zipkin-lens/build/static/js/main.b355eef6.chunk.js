(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,a){e.exports=a(386)},380:function(e,t,a){},386:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),s=a.n(i),c=a(27),o=a(390),l=a(389),u=a(388),d=a(8),h=a(9),m=a(13),p=a(11),v=a(12),f=a(387),b=function(e){return r.a.createElement("svg",Object.assign({viewBox:"0 0 886 540",fillRule:"evenodd",clipRule:"evenodd"},e),r.a.createElement("g",{transform:"translate(-147.142 -489.518) scale(1.97717)"},r.a.createElement("clipPath",{id:"prefix__a"},r.a.createElement("path",{d:"M297.97 254.996c-24.502.001-44.363 19.862-44.363 44.364.012 18.531 11.545 35.102 28.916 41.556v5.675l5.736 5.741-.659 41.828-149.649-.094c-2.371-.006-4.424-1.733-4.424-1.733-2.243-2.267 1.512-11.638 1.512-11.638l2.829-6.035c1.343-3.006 1.835-3.144 2.619-4.589-3.184.289-4.974.663-7.17 1.245-6.674 1.886-9.977 3.174-17.661 6.622-7.539 3.582-10.666 5.048-15.729 8.266-8.085 4.687-11.907 7.738-18.149 11.599.458.389.939.692 1.44.957 4.978 3.209 8.844 6.069 15.873 10.143 5.063 3.218 8.19 4.684 15.729 8.266 7.684 3.448 10.987 4.736 17.661 6.622 2.196.582 3.986.95 7.17 1.24-.784-1.446-1.276-1.577-2.619-4.584l-2.829-6.035s-3.755-9.371-1.512-11.638c0 0 1.005-.828 2.409-1.339a64.316 64.316 0 0 1 2.486-.394l43.045-.028 107.589.316.405 11.87 1.66 17.523 1.025 11.227 11.958-.005.997-10.929 1.655-17.877.438-11.809 162.516.858 21.271.692a76.26 76.26 0 0 1 13.791 2.43l7.507 2.209c1.497-1.324 2.234-2.494 2.652-3.975.584-1.938.512-4.132.532-5.785-.068-1.565-.056-3.775-.349-5.254-.458-1.442-1.15-2.651-2.647-3.976l-7.507 2.209a70.254 70.254 0 0 1-13.797 2.425l-21.52 1.102H306.358l-.072-41.816 5.741-5.183-.006-6.234c17.573-6.334 30.288-22.993 30.312-41.672 0-24.502-19.862-44.363-44.363-44.363zm-.105 7.945c24.953.414 36.781 20.345 36.568 36.623-.243 18.513-15.845 35.815-36.242 36.436-20.113 0-36.418-16.305-36.418-36.419 0-20.114 15.978-36.64 36.092-36.64z"})),r.a.createElement("g",{clipPath:"url(#prefix__a)"},r.a.createElement("path",{d:"M297.97 254.996c-24.502.001-44.363 19.862-44.363 44.364.012 18.531 11.545 35.102 28.916 41.556v5.675l5.736 5.741-.659 41.828-149.649-.094c-2.371-.006-4.424-1.733-4.424-1.733-2.243-2.267 1.512-11.638 1.512-11.638l2.829-6.035c1.343-3.006 1.835-3.144 2.619-4.589-3.184.289-4.974.663-7.17 1.245-6.674 1.886-9.977 3.174-17.661 6.622-7.539 3.582-10.666 5.048-15.729 8.266-8.085 4.687-11.907 7.738-18.149 11.599.458.389.939.692 1.44.957 4.978 3.209 8.844 6.069 15.873 10.143 5.063 3.218 8.19 4.684 15.729 8.266 7.684 3.448 10.987 4.736 17.661 6.622 2.196.582 3.986.95 7.17 1.24-.784-1.446-1.276-1.577-2.619-4.584l-2.829-6.035s-3.755-9.371-1.512-11.638c0 0 1.005-.828 2.409-1.339a64.316 64.316 0 0 1 2.486-.394l43.045-.028 107.589.316.405 11.87 1.66 17.523 1.025 11.227 11.958-.005.997-10.929 1.655-17.877.438-11.809 162.516.858 21.271.692a76.26 76.26 0 0 1 13.791 2.43l7.507 2.209c1.497-1.324 2.234-2.494 2.652-3.975.584-1.938.512-4.132.532-5.785-.068-1.565-.056-3.775-.349-5.254-.458-1.442-1.15-2.651-2.647-3.976l-7.507 2.209a70.254 70.254 0 0 1-13.797 2.425l-21.52 1.102H306.358l-.072-41.816 5.741-5.183-.006-6.234c17.573-6.334 30.288-22.993 30.312-41.672 0-24.502-19.862-44.363-44.363-44.363zm-.105 7.945c24.953.414 36.781 20.345 36.568 36.623-.243 18.513-15.845 35.815-36.242 36.436-20.113 0-36.418-16.305-36.418-36.419 0-20.114 15.978-36.64 36.092-36.64z",fillOpacity:.997,fillRule:"nonzero"}),r.a.createElement("path",{d:"M297.972 254.995c-24.501 0-44.364 19.863-44.364 44.364a44.365 44.365 0 0 0 28.913 41.558v5.675l5.74 5.739-.663 41.827-149.648-.092c-2.37-.006-4.422-1.735-4.422-1.735-2.243-2.266 1.51-11.638 1.51-11.638l2.83-6.034c1.344-3.006 1.838-3.14 2.62-4.586-3.183.29-4.976.66-7.173 1.242-6.674 1.886-9.973 3.173-17.657 6.621-7.538 3.583-10.668 5.048-15.73 8.266-8.086 4.688-11.91 7.739-18.152 11.599.457.39.942.697 1.443.962 4.978 3.21 8.843 6.066 15.872 10.14 5.063 3.218 8.192 4.685 15.73 8.268 7.685 3.447 10.984 4.735 17.658 6.62 2.196.583 3.99.952 7.173 1.241-.783-1.445-1.277-1.58-2.62-4.586l-2.83-6.032s-3.754-9.374-1.51-11.64c0 0 1.003-.83 2.407-1.342.798-.146 1.641-.27 2.49-.392l43.044-.027 107.588.318.406 11.867 1.66 17.522 1.02 11.228 11.962-.004.993-10.926 1.656-17.879.442-11.808 162.514.854 21.27.697c4.829.403 9.53 1.255 13.795 2.429l7.504 2.208c1.497-1.325 2.23-2.494 2.648-3.974.585-1.939.514-4.13.535-5.784-.069-1.565-.056-3.78-.347-5.259-.458-1.441-1.153-2.65-2.648-3.974l-7.507 2.208a70.334 70.334 0 0 1-13.795 2.428l-21.518 1.104H306.36l-.075-41.82 5.742-5.182-.006-6.233c17.573-6.335 30.29-22.995 30.314-41.674 0-24.502-19.861-44.364-44.363-44.364zm-.107 7.946c24.953.414 36.779 20.348 36.565 36.626-.242 18.513-15.84 35.811-36.237 36.432-20.113 0-36.418-16.305-36.418-36.419 0-20.113 15.976-36.639 36.09-36.639z",fill:"#231f20",fillOpacity:.997,fillRule:"nonzero"}))),r.a.createElement("path",{d:"M147.866 429.886l58.041.217-42.018 75.89 39.618-.034-.22 12.953-61.313.09 41.935-76.314h-36.26l.217-12.802zM268.748 429.777h12.875l-.012 89.252h-12.786l-.077-89.252zM456.838 429.886l12.656-.109-.058 34.693 36.713-34.675 18.36.154-45.098 42.936 45.123 46.092H506.23l-36.902-38.033.099 38.237h-12.591l.002-89.295zM585.25 429.995l12.873-.218v89.135l-12.765.109-.109-89.026zM667.62 426.612l62.835 63.906.597-61.534 12.592.091.109 93.02-63.552-63.79-.075 60.935-12.838-.22.332-92.408zM351.883 429.777c9.382.146 26.512.109 26.512.109 4.575.474 9.325 2.695 13.17 5.568 4.265 3.796 6.768 7.406 7.753 11.611.777 5.807.753 10.648.192 16.205-1.475 5.912-3.741 9.534-7.053 13.145-4.122 3.436-7.614 5-12.678 6.14-4.405.465-10.556.386-15.507.418l.309 36.546h-12.836l.138-89.742zm12.344 40.267l.164-27.42 9.736-.033c5.277.524 8.407 1.78 10.487 4.204 2.117 3.082 2.665 5.018 2.726 8.51.283 2.117-.006 4.887-1.744 8.62-1.518 2.123-1.667 2.746-4.284 4.267-3.077 1.269-1.189 1.038-7.609 1.842l-9.476.01z",fill:"#231f20",stroke:"#231f20",strokeWidth:1.4828775}))},E={browser:{url:"/zipkin",label:"Search",icon:"fa-search"},dependencies:{url:"/zipkin/dependencies",label:"Dependencies",icon:"fa-code-branch"}},g=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"renderPageOption",value:function(e){var t=this.props.location,a=E[e].url,n=t.pathname===a;return r.a.createElement("div",{className:"sidebar__page-option".concat(n?"--selected":"")},r.a.createElement(f.a,{to:{pathname:a},className:"sidebar__page-option-link".concat(n?"--selected":"")},r.a.createElement("div",{className:"sidebar__page-option-icon"},r.a.createElement("i",{className:"fas ".concat(E[e].icon)})),r.a.createElement("div",null,E[e].label)))}},{key:"render",value:function(){return r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{to:{pathname:""},className:"sidebar__brand-link"},r.a.createElement(b,{className:"sidebar__brand-logo"})),r.a.createElement("div",{className:"sidebar__menu"},this.renderPageOption("browser"),this.renderPageOption("dependencies")))}}]),t}(r.a.Component),C=a(2),k=a(10),y=a.n(k),_=a(19),O=a.n(_),N=a(3),S=a(24),T={onKeyFocus:void 0,onKeyBlur:void 0,onValueFocus:void 0,onValueBlur:void 0},j=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isKeyFocused:!1,isKeyMenuOpened:!1,isValueFocused:!1},a.nextFocusRef=void 0,a.setNextFocusRef=a.setNextFocusRef.bind(Object(C.a)(Object(C.a)(a))),a.handleKeyFocus=a.handleKeyFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleKeyBlur=a.handleKeyBlur.bind(Object(C.a)(Object(C.a)(a))),a.handleValueFocus=a.handleValueFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleValueBlur=a.handleValueBlur.bind(Object(C.a)(Object(C.a)(a))),a.handleKeyChange=a.handleKeyChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"getOptions",value:function(){return this.props.keyOptions.map(function(e){return{value:e.conditionKey,label:e.conditionKey,isDisabled:!e.isAvailable}})}},{key:"getMaxLengthOfKeyOptions",value:function(){var e=this.props.keyOptions,t=0;return e.forEach(function(e){var a=e.conditionKey.length;t<a&&(t=a)}),t}},{key:"setNextFocusRef",value:function(e){this.nextFocusRef=e}},{key:"handleKeyFocus",value:function(){var e=this,t=this.props.onKeyFocus;t&&t(),this.setState({isKeyFocused:!0}),setTimeout(function(){e.setState({isKeyMenuOpened:!0})},30)}},{key:"handleKeyBlur",value:function(){var e=this,t=this.props.onKeyBlur;t&&t(),this.setState({isKeyFocused:!1}),setTimeout(function(){e.setState({isKeyMenuOpened:!1})},30)}},{key:"handleValueFocus",value:function(){var e=this.props.onValueFocus;e&&e(),this.setState({isValueFocused:!0})}},{key:"handleValueBlur",value:function(){var e=this.props.onValueBlur;e&&e(),this.setState({isValueFocused:!1})}},{key:"handleKeyChange",value:function(e){var t=this;(0,this.props.onConditionKeyChange)(e.value),this.nextFocusRef&&setTimeout(function(){t.nextFocusRef.focus()},0)}},{key:"render",value:function(){var e=this.props,t=e.keyString,a=e.children,n=e.onDeleteButtonClick,i=this.state,s=i.isKeyFocused,c=i.isValueFocused,o=i.isKeyMenuOpened,l=this.getMaxLengthOfKeyOptions();return r.a.createElement("div",{className:"search-condition"},r.a.createElement("div",{className:"search-condition__key"},r.a.createElement(S.a,{autoFocus:!0,isSearchable:!1,value:{value:t,label:t},options:this.getOptions(),onFocus:this.handleKeyFocus,onBlur:this.handleKeyBlur,onChange:this.handleKeyChange,styles:{control:function(e){return Object(N.a)({},e,{width:"".concat(s||c?8*l+16:8*t.length+16,"px")})},indicatorsContainer:function(){return{display:"none"}},menuPortal:function(e){return Object(N.a)({},e,{zIndex:9999,width:"".concat(8*l+16,"px")})}},menuPortalTarget:document.body,classNamePrefix:"search-condition-key-select",defaultMenuIsOpen:!0,backspaceRemovesValue:!1,menuIsOpen:o})),r.a.createElement("div",{className:"search-condition__value"},a({onFocus:this.handleValueFocus,onBlur:this.handleValueBlur,setNextFocusRef:this.setNextFocusRef,isFocused:s||c})),r.a.createElement("div",{className:"search-condition__delete-button",role:"presentation",onClick:n},r.a.createElement("span",{className:"fas fa-times search-condition__delete-button-icon"})))}}]),t}(r.a.Component);j.defaultProps=T;var w=j,F=["\u03bcs","ms","s"],I=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={unit:"\u03bcs",isValueFocused:!1,isUnitFocused:!1,isUnitMenuOpened:!1},a.inputRef=void 0,a.unitRef=void 0,a.handleValueFocus=a.handleValueFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleValueBlur=a.handleValueBlur.bind(Object(C.a)(Object(C.a)(a))),a.handleValueKeyDown=a.handleValueKeyDown.bind(Object(C.a)(Object(C.a)(a))),a.handleValueChange=a.handleValueChange.bind(Object(C.a)(Object(C.a)(a))),a.handleUnitFocus=a.handleUnitFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleUnitBlur=a.handleUnitBlur.bind(Object(C.a)(Object(C.a)(a))),a.handleUnitChange=a.handleUnitChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"calculateDisplayedValue",value:function(){var e=this.props.value;switch(this.state.unit){case"\u03bcs":return e;case"ms":return e/1e3;case"s":return e/1e6;default:return null}}},{key:"handleValueFocus",value:function(){var e=this.props.onFocus;this.setState({isValueFocused:!0}),e()}},{key:"handleValueBlur",value:function(){var e=this.props.onBlur,t=this.state.isUnitFocused;this.setState({isValueFocused:!1}),t||e()}},{key:"handleUnitFocus",value:function(){var e=this,t=this.props.onFocus;this.setState({isUnitFocused:!0}),t(),setTimeout(function(){e.setState({isUnitMenuOpened:!0})},100)}},{key:"handleUnitBlur",value:function(){var e=this.props.onBlur,t=this.state.isValueFocused;this.setState({isUnitFocused:!1}),t||e(),this.setState({isUnitMenuOpened:!1})}},{key:"handleValueKeyDown",value:function(e){13===e.keyCode&&(this.inputRef.blur(),this.unitRef.focus())}},{key:"handleValueChange",value:function(e){var t=parseInt(e.target.value,10);Number.isNaN(t)&&(t=0);var a=this.props.onConditionChange;switch(this.state.unit){case"\u03bcs":a(String(t));break;case"ms":a(String(1e3*t));break;case"s":a(String(1e3*t*1e3))}}},{key:"handleUnitChange",value:function(e){var t=this.state.unit,a=this.props,n=a.value,r=a.onConditionChange,i=e.value;switch(this.setState({unit:i}),t){case"\u03bcs":switch(i){case"ms":r(String(1e3*n));break;case"s":r(String(1e3*n*1e3))}break;case"ms":switch(i){case"\u03bcs":r(String(n/1e3));break;case"s":r(String(1e3*n))}break;case"s":switch(i){case"\u03bcs":r(String(n/1e6));break;case"ms":r(String(n/1e3))}}}},{key:"render",value:function(){var e=this,t=this.props,a=t.setNextFocusRef,n=t.isFocused,i=this.state,s=i.unit,c=i.isUnitMenuOpened,o=this.calculateDisplayedValue();return r.a.createElement("div",{className:"condition-duration"},r.a.createElement("input",{ref:function(t){a(t),e.inputRef=t},type:"number",value:o,onChange:this.handleValueChange,className:"condition-duration__value-input",style:{width:"".concat(n?76:8*o.length+20,"px")},onFocus:this.handleValueFocus,onBlur:this.handleValueBlur,onKeyDown:this.handleValueKeyDown,min:0}),r.a.createElement(S.a,{ref:function(t){e.unitRef=t},isSearchable:!1,value:{value:s,label:s},options:F.map(function(e){return{value:e,label:e}}),styles:{control:function(e){return Object(N.a)({},e,{width:"38px"})},indicatorsContainer:function(){return{display:"none"}},menuPortal:function(e){return Object(N.a)({},e,{zIndex:9999,width:"38px"})}},menuPortalTarget:document.body,onChange:this.handleUnitChange,classNamePrefix:"condition-duration-unit-select",onFocus:this.handleUnitFocus,onBlur:this.handleUnitBlur,blurInputOnSelect:!0,menuIsOpen:c}))}}]),t}(r.a.Component),L=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isFocused:!1},a.inputRef=void 0,a.handleKeyDown=a.handleKeyDown.bind(Object(C.a)(Object(C.a)(a))),a.handleFocus=a.handleFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleBlur=a.handleBlur.bind(Object(C.a)(Object(C.a)(a))),a.handleValueChange=a.handleValueChange.bind(Object(C.a)(Object(C.a)(a))),a.handleClick=a.handleClick.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.inputRef.blur()}},{key:"handleFocus",value:function(){this.setState({isFocused:!0})}},{key:"handleBlur",value:function(){this.setState({isFocused:!1})}},{key:"handleValueChange",value:function(e){var t=this.props.onLimitChange,a=parseInt(e.target.value,10);Number.isNaN(a)&&(a=0),t(a)}},{key:"handleClick",value:function(){var e=this;this.handleFocus(),setTimeout(function(){e.inputRef.focus()},0)}},{key:"render",value:function(){var e=this,t=this.state.isFocused,a=this.props.limit;return r.a.createElement("div",{className:"condition-limit"},t?r.a.createElement("input",{ref:function(t){e.inputRef=t},type:"number",value:a,onChange:this.handleValueChange,className:"condition-limit__input condition-limit__input--focused",onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,min:0}):r.a.createElement("div",{className:"condition-limit__input",role:"presentation",onClick:this.handleClick},"Max ".concat(a)))}}]),t}(r.a.Component),x={value:void 0},R=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isMenuOpened:!1},a.handleFocus=a.handleFocus.bind(Object(C.a)(Object(C.a)(a))),a.handleBlur=a.handleBlur.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"getMaxLengthOfOptions",value:function(){var e=this.props.options,t=4;return e.forEach(function(e){var a=e.length;t<a&&(t=a)}),t}},{key:"getOptions",value:function(){var e=this.props.options,t=[];return e.forEach(function(e){t.push({value:e,label:e})}),t}},{key:"handleFocus",value:function(){var e=this;(0,this.props.onFocus)(),setTimeout(function(){e.setState({isMenuOpened:!0})},100)}},{key:"handleBlur",value:function(){(0,this.props.onBlur)(),this.setState({isMenuOpened:!1})}},{key:"calculateOptimumWidth",value:function(){var e=this.props,t=e.isFocused,a=e.value,n=this.getMaxLengthOfOptions();return t?"".concat(8*n+16,"px"):a?"".concat(8*a.length+16,"px"):"36px"}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,n=t.onConditionChange,i=t.setNextFocusRef,s=t.isLoadingOptions,c=this.state.isMenuOpened,o=this.getOptions(),l=this.getMaxLengthOfOptions();return r.a.createElement("div",{className:"condition-name"},r.a.createElement(S.a,{ref:function(e){i(e)},value:{value:a,label:a},options:o,onFocus:this.handleFocus,onBlur:this.handleBlur,styles:{control:function(t){return Object(N.a)({},t,{width:e.calculateOptimumWidth()})},indicatorsContainer:function(){return{display:"none"}},menuPortal:function(e){return Object(N.a)({},e,{zIndex:9999,width:"".concat(8*l+16,"px")})}},onChange:function(e){n(e.value)},menuPortalTarget:document.body,classNamePrefix:"condition-name-select",blurInputOnSelect:!0,menuIsOpen:c,isLoading:s}))}}]),t}(r.a.Component);R.defaultProps=x;var D=R,A=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).inputRef=void 0,a.handleKeyDown=a.handleKeyDown.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.inputRef.blur()}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,n=t.onConditionChange,i=t.setNextFocusRef,s=t.onFocus,c=t.onBlur,o=t.isFocused;return r.a.createElement("div",{className:"condition-annotation-query"},r.a.createElement("input",{ref:function(t){i(t),e.inputRef=t},type:"text",value:a,onChange:function(e){n(e.target.value)},className:"condition-annotation-query__input",style:{width:"".concat(o?176:8*a.length+16,"px")},onFocus:s,onBlur:c,onKeyDown:this.handleKeyDown}))}}]),t}(r.a.Component),M=a(161),U=a(149),B=a.n(U),P=a(162),V=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleDateChange=a.handleDateChange.bind(Object(C.a)(Object(C.a)(a))),a.handleTimeChange=a.handleTimeChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleDateChange",value:function(e){var t=this.props,a=t.selected;(0,t.onChange)(y()({year:e.year(),month:e.month(),day:e.date(),hour:a.hour(),minute:a.minute(),second:a.second(),millisecond:a.millisecond()}))}},{key:"handleTimeChange",value:function(e){var t=this.props,a=t.selected;(0,t.onChange)(y()({year:a.year(),month:a.month(),day:a.date(),hour:e.hour(),minute:e.minute(),second:e.second(),millisecond:e.millisecond()}))}},{key:"render",value:function(){var e=this.props.selected;return r.a.createElement("div",{className:"date-picker"},r.a.createElement(B.a,{className:"date-picker__calendar",calendar:r.a.createElement(M.a,null),onChange:this.handleDateChange},function(){return r.a.createElement("span",null,r.a.createElement("input",{className:"date-picker__calendar-input",value:e?e.format("MMM Do YY"):"",type:"text",readOnly:!0}))}),r.a.createElement(P.a,{className:"date-picker__timepicker",onChange:this.handleTimeChange,value:e}))}}]),t}(r.a.Component),H=[{value:"1h",label:"1 Hour"},{value:"2h",label:"2 Hours"},{value:"6h",label:"6 Hours"},{value:"12h",label:"12 Hours"},{value:"1d",label:"1 Day"},{value:"2d",label:"2 Days"},{value:"7d",label:"7 Days"},{value:"custom",label:"Custom"}],K=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleLookbackChange=a.handleLookbackChange.bind(Object(C.a)(Object(C.a)(a))),a.handleEndTsChange=a.handleEndTsChange.bind(Object(C.a)(Object(C.a)(a))),a.handleStartTsChange=a.handleStartTsChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleLookbackChange",value:function(e){var t=this.props,a=t.lookback,n=t.onLookbackChange;switch(e.value){case"custom":n({value:"custom",endTs:a.endTs,startTs:a.endTs});break;default:n({value:e.value,endTs:a.endTs})}}},{key:"handleEndTsChange",value:function(e){var t=this.props,a=t.lookback;(0,t.onLookbackChange)({value:"custom",endTs:e.valueOf(),startTs:a.startTs})}},{key:"handleStartTsChange",value:function(e){var t=this.props,a=t.lookback;(0,t.onLookbackChange)({value:"custom",endTs:a.endTs,startTs:e.valueOf()})}},{key:"render",value:function(){var e=this.props.lookback,t=H.find(function(t){return t.value===e.value});return r.a.createElement("div",{className:"condition-lookback"},r.a.createElement(S.a,{value:t,options:H,styles:{control:function(e){return Object(N.a)({},e,{width:"80px"})},indicatorsContainer:function(){return{display:"none"}},menuPortal:function(e){return Object(N.a)({},e,{zIndex:9999,width:"80px"})}},menuPortalTarget:document.body,classNamePrefix:"condition-lookback-select",onChange:this.handleLookbackChange}),"custom"===e.value?r.a.createElement("div",{className:"condition-lookback__custom"},r.a.createElement("div",null,r.a.createElement("div",{className:"condition-lookback__custom-date-picker"},r.a.createElement(V,{selected:y()(e.startTs),onChange:this.handleStartTsChange})),r.a.createElement("div",{className:"condition-lookback__custom-date-picker"},r.a.createElement("div",{className:"condition-lookback__custom-tilda-indicator"},"-"),r.a.createElement(V,{selected:y()(e.endTs),onChange:this.handleEndTsChange})))):null)}}]),t}(r.a.Component),W=a(29),z=function(e){var t={};return Object.keys(e).forEach(function(a){e[a]&&(t[a]=e[a])}),O.a.stringify(t)},Q={"1h":36e5,"2h":72e5,"6h":216e5,"12h":432e5,"1d":864e5,"2d":1728e5,"7d":6048e5},G=function(e){return["serviceName","spanName","minDuration","maxDuration"].concat(Object(W.a)(e),["annotationQuery"])},Y=function(e){switch(e){case"serviceName":case"spanName":case"minDuration":case"maxDuration":case"annotationQuery":return!1;default:return!0}},X=function(e){switch(e){case"serviceName":case"spanName":return;case"minDuration":return 10;case"maxDuration":return 100;case"annotationQuery":return"";default:return}},q=function(e,t,a){var n={};t.forEach(function(e){"annotationQuery"!==e.key&&(n[e.key]=!0)});for(var r=G(a),i=[],s=0;s<r.length;s+=1){var c=r[s];if(c!==e){var o=!1;n[c]||(o=!0),i.push({conditionKey:c,isAvailable:o})}else i.push({conditionKey:c,isAvailable:!0})}return i},J=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleAddButtonClick=a.handleAddButtonClick.bind(Object(C.a)(Object(C.a)(a))),a.handleSearchButtonClick=a.handleSearchButtonClick.bind(Object(C.a)(Object(C.a)(a))),a.handleDeleteConditionButtonClick=a.handleDeleteConditionButtonClick.bind(Object(C.a)(Object(C.a)(a))),a.handleConditionKeyChange=a.handleConditionKeyChange.bind(Object(C.a)(Object(C.a)(a))),a.handleConditionValueChange=a.handleConditionValueChange.bind(Object(C.a)(Object(C.a)(a))),a.handleLookbackChange=a.handleLookbackChange.bind(Object(C.a)(Object(C.a)(a))),a.handleLimitChange=a.handleLimitChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchServices,a=e.fetchSpans,n=e.fetchAutocompleteKeys,r=e.location,i=e.addCondition,s=e.setLookbackCondition,c=e.setLimitCondition,o=this.getConditionsFromQueryParameters(),l=o.conditions,u=o.lookbackCondition,d=o.limitCondition;l.forEach(function(e){i(e)}),s({value:u.value||"1h",endTs:u.endTs||y()().valueOf(),startTs:u.startTs||y()().valueOf()}),c(d||10),t();var h=o.conditions.find(function(e){return"serviceName"===e.key});h&&a(h.value),n(),this.fetchTraces(r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location,a=this.props.location;""!==t.search&&"?"!==t.search&&a.search!==t.search&&this.fetchTraces(t)}},{key:"getConditionsFromQueryParameters",value:function(){var e=this.props.location;return""!==e.search&&"?"!==e.search?function(e){var t=[],a={},n=0;return Object.keys(e).forEach(function(r){var i=e[r];switch(r){case"serviceName":case"spanName":t.push({key:r,value:i});break;case"minDuration":case"maxDuration":t.push({key:r,value:parseInt(i,10)});break;case"annotationQuery":i.split(" and ").forEach(function(e){t.push({key:"annotationQuery",value:e})});break;case"autocompleteTags":i.split(" and ").forEach(function(e){var a=e.split("=");t.push({key:a[0],value:a[1]})});break;case"limit":n=parseInt(i,10);break;case"lookback":switch(i){case"1h":case"2h":case"6h":case"12h":case"1d":case"2d":case"7d":a.value=i,a.endTs=parseInt(e.endTs,10);break;case"custom":a.value=i,a.endTs=parseInt(e.endTs,10),a.startTs=parseInt(e.startTs,10)}}}),{conditions:t,lookbackCondition:a,limitCondition:n}}(O.a.parse(e.search)):{conditions:[],lookbackCondition:{},limitCondition:null}}},{key:"fetchTraces",value:function(e){var t=this.props.fetchTraces;""!==e.search&&"?"!==e.search&&t(function(e){var t,a={};return Object.keys(e).forEach(function(n){var r=e[n];switch(n){case"serviceName":case"spanName":case"minDuration":case"maxDuration":case"limit":a[n]=r;break;case"annotationQuery":case"autocompleteTags":t="undefined"===typeof t?r:t.concat(" and ",r);break;case"lookback":switch(r){case"1h":case"2h":case"6h":case"12h":case"1d":case"2d":case"7d":a.endTs=e.endTs,a.lookback=String(Q[r]);break;case"custom":a.endTs=e.endTs,a.lookback=String(parseInt(e.endTs,10)-parseInt(e.startTs,10))}}}),a.annotationQuery=t,a}(O.a.parse(e.search)))}},{key:"handleAddButtonClick",value:function(){var e=this.props,t=e.addCondition,a=function(e,t){var a=G(t),n={};e.forEach(function(e){n[e.key]=!0});for(var r=0;r<a.length;r+=1){var i=a[r];if(!n[i])return i}return"annotationQuery"}(e.conditions,e.autocompleteKeys);t({key:a,value:X(a)})}},{key:"handleSearchButtonClick",value:function(){var e=this.props,t=e.history,a=function(e,t,a){var n=[],r=[],i={};return e.forEach(function(e){switch(e.key){case"serviceName":case"spanName":case"minDuration":case"maxDuration":i[e.key]=e.value;break;case"annotationQuery":n.push(e.value);break;default:r.push("".concat(e.key,"=").concat(e.value))}}),i.annotationQuery=n.join(" and "),i.autocompleteTags=r.join(" and "),i.limit=a,i.lookback=t.value,i.endTs=t.endTs,"custom"===t.value&&(i.startTs=t.startTs),z(i)}(e.conditions,e.lookbackCondition,e.limitCondition);t.push({pathname:"/zipkin",search:a})}},{key:"handleConditionKeyChange",value:function(e,t){var a=this.props,n=a.changeConditionKey,r=a.fetchAutocompleteValues;n(e,t),Y(t)&&r(t)}},{key:"handleConditionValueChange",value:function(e,t){var a=this.props,n=a.fetchSpans,r=a.conditions;(0,a.changeConditionValue)(e,t),"serviceName"===r[e].key&&n(t)}},{key:"handleDeleteConditionButtonClick",value:function(e){(0,this.props.deleteCondition)(e)}},{key:"handleLookbackChange",value:function(e){(0,this.props.setLookbackCondition)(e)}},{key:"handleLimitChange",value:function(e){(0,this.props.setLimitCondition)(e)}},{key:"renderCondition",value:function(e,t,a){var n=this,i=this.props,s=i.services,c=i.spans,o=i.isLoadingServices,l=i.isLoadingSpans,u=i.autocompleteValues,d=i.isLoadingAutocompleteValues,h={value:a,onConditionChange:function(e){n.handleConditionValueChange(t,e)}};switch(e){case"serviceName":case"spanName":var m,p;return"serviceName"===e?(m=s,p=o):(m=c,p=l),function(e){var t=e.onFocus,a=e.onBlur,n=e.setNextFocusRef,i=e.isFocused;return r.a.createElement(D,Object.assign({},h,{options:m,onFocus:t,onBlur:a,setNextFocusRef:n,isFocused:i,isLoadingOptions:p}))};case"minDuration":case"maxDuration":return function(e){var t=e.onFocus,a=e.onBlur,n=e.setNextFocusRef,i=e.isFocused;return r.a.createElement(I,Object.assign({},h,{onFocus:t,onBlur:a,setNextFocusRef:n,isFocused:i}))};case"annotationQuery":return function(e){var t=e.onFocus,a=e.onBlur,n=e.setNextFocusRef,i=e.isFocused;return r.a.createElement(A,Object.assign({},h,{onFocus:t,onBlur:a,setNextFocusRef:n,isFocused:i}))};default:return function(e){var t=e.onFocus,a=e.onBlur,n=e.setNextFocusRef,i=e.isFocused;return r.a.createElement(D,Object.assign({},h,{options:u,onFocus:t,onBlur:a,setNextFocusRef:n,isFocused:i,isLoadingOptions:d}))}}}},{key:"renderSearchCondition",value:function(e,t){var a=this,n=this.props,i=n.conditions,s=n.autocompleteKeys,c=n.fetchAutocompleteValues,o={keyString:e.key,keyOptions:q(e.key,i,s),onConditionKeyChange:function(e){a.handleConditionKeyChange(t,e)},onDeleteButtonClick:function(){a.handleDeleteConditionButtonClick(t)}};return Y(e.key)?r.a.createElement(w,Object.assign({},o,{onKeyFocus:function(){c(e.key)},onValueFocus:function(){c(e.key)}}),this.renderCondition(e.key,t,e.value)):r.a.createElement(w,o,this.renderCondition(e.key,t,e.value))}},{key:"render",value:function(){var e=this,t=this.props,a=t.conditions,n=t.lookbackCondition,i=t.limitCondition;return r.a.createElement("div",{className:"global-search"},r.a.createElement("div",{className:"global-search__conditions"},0===a.length?r.a.createElement("div",{className:"global-search__placeholder"},"Please select the criteria for your trace lookup."):a.map(function(t,a){return r.a.createElement("div",{key:t._id,className:"global-search__search-condition-wrapper"},e.renderSearchCondition(t,a))}),r.a.createElement("div",{role:"presentation",onClick:this.handleAddButtonClick,className:"global-search__add-condition-button"},r.a.createElement("span",{className:"fas fa-plus global-search__add-condition-button-icon"})),r.a.createElement("div",{role:"presentation",onClick:this.handleSearchButtonClick,className:"global-search__find-button"},r.a.createElement("span",{className:"fas fa-search global-search__find-button-icon"}))),r.a.createElement("div",{className:"global-search__condition-limit-wrapper"},r.a.createElement(L,{limit:i,onLimitChange:this.handleLimitChange})),r.a.createElement("div",{className:"global-search__condition-lookback-wrapper"},r.a.createElement(K,{lookback:n,onLookbackChange:this.handleLookbackChange})))}}]),t}(r.a.Component),Z=Object(u.a)(J),$=a(18),ee=a.n($),te=a(23),ae=Object({NODE_ENV:"production",PUBLIC_URL:""}).API_BASE,ne="".concat(ae||"","/zipkin/api/v2"),re="".concat(ne,"/services"),ie="".concat(ne,"/spans"),se="".concat(ne,"/traces"),ce="".concat(ne,"/trace"),oe="".concat(ne,"/dependencies"),le="".concat(ne,"/autocompleteKeys"),ue="".concat(ne,"/autocompleteValues"),de=function(e){return{type:"FETCH_SPANS_SUCCESS",spans:e}},he=function(e){return{type:"FETCH_SERVICES_SUCCESS",services:e}},me=function(e){return{type:"FETCH_TRACES_SUCCESS",traces:e}},pe=function(e){return{type:"FETCH_AUTOCOMPLETE_KEYS_SUCCESS",autocompleteKeys:e}},ve=function(e){return{type:"FETCH_AUTOCOMPLETE_VALUES_SUCCESS",autocompleteValues:e}},fe=Object(c.b)(function(e){return{services:e.services.services,isLoadingServices:e.services.isLoading,spans:e.spans.spans,isLoadingSpans:e.spans.isLoading,conditions:e.globalSearch.conditions,lookbackCondition:e.globalSearch.lookbackCondition,limitCondition:e.globalSearch.limitCondition,autocompleteKeys:e.autocompleteKeys.autocompleteKeys,isLoadingAutocompleteKeys:e.autocompleteKeys.isLoading,autocompleteValues:e.autocompleteValues.autocompleteValues,isLoadingAutocompleteValues:e.autocompleteValues.isLoading}},function(e){return{fetchServices:function(){return e(function(){var e=Object(te.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_SERVICES_REQUEST"}),e.prev=1,e.next=4,fetch(re);case 4:if((a=e.sent).ok){e.next=7;break}throw Error(a.statusText);case 7:return e.next=9,a.json();case 9:n=e.sent,t(he(n)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t({type:"FETCH_SERVICES_FAILURE"});case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}())},fetchSpans:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark(function t(a){var n,r,i;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"FETCH_SPANS_REQUEST"}),t.prev=1,n=O.a.stringify({serviceName:e}),t.next=5,fetch("".concat(ie,"?").concat(n));case 5:if((r=t.sent).ok){t.next=8;break}throw Error(r.statusText);case 8:return t.next=10,r.json();case 10:i=t.sent,a(de(i)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),a({type:"FETCH_SPANS_FAILURE"});case 17:case"end":return t.stop()}},t,this,[[1,14]])}));return function(e){return t.apply(this,arguments)}}()}(t))},fetchTraces:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark(function t(a){var n,r,i;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"FETCH_TRACES_REQUEST"}),t.prev=1,n=O.a.stringify(e),t.next=5,Promise.all([fetch("".concat(se,"?").concat(n)),new Promise(function(e){return setTimeout(e,500)})]);case 5:if((r=t.sent)[0].ok){t.next=8;break}throw Error(r[0].statusText);case 8:return t.next=10,r[0].json();case 10:i=t.sent,a(me(i)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),a({type:"FETCH_TRACES_FAILURE"});case 17:case"end":return t.stop()}},t,this,[[1,14]])}));return function(e){return t.apply(this,arguments)}}()}(t))},fetchAutocompleteKeys:function(){return e(function(){var e=Object(te.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_AUTOCOMPLETE_KEYS_REQUEST"}),e.prev=1,e.next=4,fetch(le);case 4:if((a=e.sent).ok){e.next=7;break}throw Error(a.statusText);case 7:return e.next=9,a.json();case 9:n=e.sent,t(pe(n)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t({type:"FETCH_AUTOCOMPLETE_KEYS_FAILURE"});case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}())},fetchAutocompleteValues:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark(function t(a){var n,r,i;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"FETCH_AUTOCOMPLETE_VALUES_REQUEST"}),t.prev=1,n=O.a.stringify({key:e}),t.next=5,fetch("".concat(ue,"?").concat(n));case 5:if((r=t.sent).ok){t.next=8;break}throw Error(r.statusText);case 8:return t.next=10,r.json();case 10:i=t.sent,a(ve(i)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),a({type:"FETCH_AUTOCOMPLETE_VALUES_FAILURE"});case 17:case"end":return t.stop()}},t,this,[[1,14]])}));return function(e){return t.apply(this,arguments)}}()}(t))},setLookbackCondition:function(t){return e(function(e){return{type:"GLOBAL_SEARCH_SET_LOOKBACK_CONDITION",lookbackCondition:e}}(t))},setLimitCondition:function(t){return e(function(e){return{type:"GLOBAL_SEARCH_SET_LIMIT_CONDITION",limitCondition:e}}(t))},addCondition:function(t){return e(function(){return{type:"GLOBAL_SEARCH_ADD_CONDITION",condition:arguments.length>0&&void 0!==arguments[0]?arguments[0]:null}}(t))},deleteCondition:function(t){return e(function(e){return{type:"GLOBAL_SEARCH_DELETE_CONDITION",index:e}}(t))},changeConditionKey:function(t,a){e(function(e,t){return{type:"GLOBAL_SEARCH_CHANGE_CONDITION_KEY",index:e,conditionKey:t}}(t,a))},changeConditionValue:function(t,a){e(function(e,t){return{type:"GLOBAL_SEARCH_CHANGE_CONDITION_VALUE",index:e,conditionValue:t}}(t,a))}}})(Z),be=Object(u.a)(fe),Ee=Object(u.a)(function(e){var t=e.location,a=e.children;return r.a.createElement("div",{className:"app__layout"},r.a.createElement(g,{location:t}),r.a.createElement("div",{className:"app__global-search-wrapper"},r.a.createElement(be,null)),r.a.createElement("div",{className:"app__content"},a))}),ge=a(38),Ce=function(e){return 0===e||"undefined"===typeof e?"0ms":e<1e3?"".concat(e,"\u03bc"):e<1e6?"".concat((e/1e3).toFixed(3),"ms"):"".concat((e/1e6).toFixed(3),"s")},ke=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={widthChangingColumn:null},a._element=void 0,a.setElement=a.setElement.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseDown=a.handleMouseDown.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseMove=a.handleMouseMove.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseUp=a.handleMouseUp.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"setElement",value:function(e){this._element=e}},{key:"getPosition",value:function(e){var t=this._element.getBoundingClientRect();return(e-t.left)/t.width}},{key:"handleMouseDown",value:function(e,t){0===e.button&&(this.setState({widthChangingColumn:t}),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp))}},{key:"handleMouseMove",value:function(e){var t=this.props,a=t.serviceNameColumnWidth,n=t.onServiceNameColumnWidthChange,r=t.onSpanNameColumnWidthChange;switch(this.state.widthChangingColumn){case"service":n(Math.max(this.getPosition(e.clientX),.075));break;case"span":r(Math.max(this.getPosition(e.clientX)-a,.075))}}},{key:"handleMouseUp",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"renderTicks",value:function(){for(var e=this.props,t=e.startTs,a=e.endTs,n=e.numTimeMarkers,i=[],s=0;s<n;s+=1){var c=t+s/(n-1)*(a-t),o=s/(n-1),l="";o<=0?l="first":o>=1&&(l="last"),i.push(r.a.createElement("div",{key:o,className:"timeline__time-marker ".concat(l),style:{left:"".concat(100*o,"%")}},r.a.createElement("span",{className:"timeline__header-row-time-marker-label ".concat(l)},Ce(c))))}return r.a.createElement("div",null,i)}},{key:"render",value:function(){var e=this,t=this.props,a=t.serviceNameColumnWidth,n=t.spanNameColumnWidth;return r.a.createElement("div",{className:"timeline__header-row",ref:this.setElement},r.a.createElement("div",{className:"timeline__header-row-title-splitter-wrapper",style:{width:"".concat(100*a,"%")}},r.a.createElement("div",{className:"timeline__header-row-title"},"Service Name"),r.a.createElement("div",{className:"timeline__header-row-splitter",role:"presentation",onMouseDown:function(t){e.handleMouseDown(t,"service")}},"||")),r.a.createElement("div",{className:"timeline__header-row-title-splitter-wrapper",style:{width:"".concat(100*n,"%")}},r.a.createElement("div",{className:"timeline__header-row-title"},"Span Name"),r.a.createElement("div",{className:"timeline__header-row-splitter",role:"presentation",onMouseDown:function(t){e.handleMouseDown(t,"span")}},"||")),r.a.createElement("div",{className:"timeline__header-row-time-markers",style:{width:"".concat(100*(1-(a+n)),"%")}},this.renderTicks()))}}]),t}(r.a.Component),ye=a(104),_e=function(e){switch(e){case"transient":case"critical":return"#da8b8b";default:return"#9bbdda"}},Oe=function(e){switch(e.length%10){case 0:return"#00ACED";case 1:return"#5AE628";case 2:return"#CD201F";case 3:return"#D1AD59";case 4:return"#FF5A60";case 5:return"#563D7C";case 6:return"#00B489";case 7:return"#F8630E";case 8:return"#FF5700";default:return"#111111"}},Ne=function(e){var t=e.serviceName,a=e.count,n=e.className,i={backgroundColor:Oe(t)},s=a?"".concat(t," x ").concat(a):t;return r.a.createElement("span",{style:i,className:"service-name-badge ".concat(n)},s)};Ne.defaultProps={count:null,className:""};var Se=Ne,Te=function(e){var t=e.span,a=e.serviceNameColumnWidth;return r.a.createElement("div",{className:"timeline__span-info"},r.a.createElement("div",{className:"timeline__span-info-left",style:{width:"".concat(100*a,"%")}},r.a.createElement("span",{className:"timeline__span-info-left-depth-marker",style:{left:"".concat(14*t.depth,"px"),background:"".concat(Oe(t.serviceName))}})),r.a.createElement("div",{className:"timeline__span-info-right",style:{left:"".concat(100*a,"%"),width:"".concat(100*(1-a),"%")}},function(e){return r.a.createElement("div",{className:"timeline__span-info-info"},r.a.createElement("div",{className:"timeline__span-info-info-title",style:{borderColor:Oe(e.serviceName)}},"".concat(e.serviceName,": ").concat(e.spanName)),r.a.createElement("div",{className:"timeline__span-info-info-aka"},e.serviceNames?e.serviceNames.map(function(e){return r.a.createElement(Se,{key:e,serviceName:e,className:"timeline__span-info-info-aka-badge"})}):null),r.a.createElement(ye.a,{showPagination:!1,minRows:0,data:e.annotations.map(function(e){return{duration:y()(e.timestamp/1e3).format("MM/DD HH:mm:ss:SSS"),relativeTime:e.relativeTime,annotation:e.value,address:e.endpoint}}),columns:[{Header:"Date Time",accessor:"duration"},{Header:"Relative Time",accessor:"relativeTime"},{Header:"Annotation",accessor:"annotation"},{Header:"Address",accessor:"address"}]}),r.a.createElement(ye.a,{showPagination:!1,minRows:0,data:e.tags,columns:[{Header:"Key",accessor:"key"},{Header:"Value",accessor:"value"}]}))}(t)))},je=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChildrenToggle=a.handleChildrenToggle.bind(Object(C.a)(Object(C.a)(a))),a.handleInfoToggle=a.handleInfoToggle.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleChildrenToggle",value:function(e){e.stopPropagation();var t=this.props,a=t.span;(0,t.onChildrenToggle)(a.spanId)}},{key:"handleInfoToggle",value:function(){var e=this.props,t=e.span;(0,e.onInfoToggle)(t.spanId)}},{key:"renderServiceNameColumn",value:function(){var e=this.props,t=e.span,a=e.hasChildren,n=e.isChildrenOpened;return r.a.createElement("div",{className:"timeline__span-service-name-column"},a?r.a.createElement("div",{className:"timeline__span-service-name-column-button",style:{left:"".concat(14*(t.depth-1),"px")},onClick:this.handleChildrenToggle,role:"presentation"},n?r.a.createElement("span",{className:"fas fa-minus-square"}):r.a.createElement("span",{className:"fas fa-plus-square"})):null,r.a.createElement("span",{className:"timeline__span-service-name-column-depth-marker",style:{left:"".concat(14*t.depth,"px"),background:"".concat(Oe(t.serviceName))}}),r.a.createElement("div",{className:"timeline__span-service-name-column-name-wrapper",style:{left:"".concat(14*(t.depth+1),"px")}},r.a.createElement("div",{className:"timeline__span-service-name-column-name"},t.serviceName)))}},{key:"renderTimeMarkersAndBar",value:function(){for(var e=this.props,t=e.startTs,a=e.endTs,n=e.span,i=e.numTimeMarkers,s=e.traceDuration,c=[],o=1;o<i-1;o+=1){var l=o/(i-1);c.push(r.a.createElement("span",{key:l,className:"timeline__time-marker",style:{left:"".concat(100*l,"%")}}))}var u,d,h=n.left*s/100,m=h+n.width*s/100,p=a-t;return h<t&&m<t?(u=0,d=0):h>=a?(u=100,d=0):h<t&&m>t&&m<a?(u=0,d=(m-t)/p*100):h<t&&m>t&&m>a?(u=0,d=100):h>=t&&h<a&&m<=a?(u=(h-t)/p*100,d=(m-h)/p*100):h>=t&&h<a&&m>a?(u=(h-t)/p*100,d=(a-h)/p*100):(u=0,d=0),r.a.createElement("div",null,c,r.a.createElement("div",{className:"timeline__span-bar-wrapper"},r.a.createElement("span",{className:"timeline__span-bar",style:{left:"".concat(u,"%"),width:"".concat(d,"%"),background:"".concat(_e(n.errorType))}},r.a.createElement("span",{className:"timeline__span-duration ".concat(parseInt(u,10)>50?"right":"left")},n.durationStr))))}},{key:"render",value:function(){var e=this.props,t=e.span,a=e.serviceNameColumnWidth,n=e.spanNameColumnWidth,i=e.isInfoOpened;return r.a.createElement("div",null,r.a.createElement("div",{role:"presentation",className:"timeline__span",onClick:this.handleInfoToggle},r.a.createElement("div",{className:"timeline__span-service-name-column-wrapper",style:{width:"".concat(100*a,"%")}},this.renderServiceNameColumn()),r.a.createElement("div",{className:"timeline__span-span-name-column-wrapper",style:{width:"".concat(100*n,"%")}},r.a.createElement("div",{className:"timeline__span-span-name-column"},t.spanName)),r.a.createElement("div",{className:"timeline__span-time-markers-bar",style:{width:"".concat(100*(1-(a+n)),"%")}},this.renderTimeMarkersAndBar())),i?r.a.createElement(Te,{span:t,serviceNameColumnWidth:a}):null)}}]),t}(r.a.Component),we=.2,Fe=.1,Ie=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={serviceNameColumnWidth:we,spanNameColumnWidth:Fe,childrenClosed:{},infoOpened:{}},a.handleServiceNameColumnChange=a.handleServiceNameColumnChange.bind(Object(C.a)(Object(C.a)(a))),a.handleSpanNameColumnChange=a.handleSpanNameColumnChange.bind(Object(C.a)(Object(C.a)(a))),a.handleChildrenToggle=a.handleChildrenToggle.bind(Object(C.a)(Object(C.a)(a))),a.handleInfoToggle=a.handleInfoToggle.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleServiceNameColumnChange",value:function(e){this.setState({serviceNameColumnWidth:e})}},{key:"handleSpanNameColumnChange",value:function(e){this.setState({spanNameColumnWidth:e})}},{key:"handleChildrenToggle",value:function(e){var t=this.state.childrenClosed;t[e]?t[e]=void 0:t[e]=!0,this.setState({childrenClosed:t})}},{key:"handleInfoToggle",value:function(e){var t=this.state.infoOpened;t[e]?t[e]=!1:t[e]=!0,this.setState({infoOpened:t})}},{key:"isChildrenOpened",value:function(e){return!this.state.childrenClosed[e]}},{key:"isInfoOpened",value:function(e){return!!this.state.infoOpened[e]}},{key:"render",value:function(){for(var e=this,t=this.props,a=t.startTs,n=t.endTs,i=t.traceSummary,s=this.state,c=s.serviceNameColumnWidth,o=s.spanNameColumnWidth,l=s.childrenClosed,u={},d=0;d<i.spans.length;d+=1)l[i.spans[d].parentId]&&(u[i.spans[d].spanId]=!0);return r.a.createElement("div",{className:"timeline"},r.a.createElement(ke,{startTs:a,endTs:n,serviceNameColumnWidth:c,spanNameColumnWidth:o,numTimeMarkers:5,onServiceNameColumnWidthChange:this.handleServiceNameColumnChange,onSpanNameColumnWidthChange:this.handleSpanNameColumnChange}),i.spans.map(function(t,s,l){var d=!1;if(s<l.length-1&&l[s+1].depth>t.depth&&(d=!0),u[t.spanId]){if(d)for(var h=0;h<t.childIds.length;h+=1)u[t.childIds[h]]=!0;return null}return r.a.createElement(je,{key:t.spanId,startTs:a,endTs:n,traceDuration:i.duration,numTimeMarkers:5,serviceNameColumnWidth:c,spanNameColumnWidth:o,span:t,hasChildren:d,isChildrenOpened:e.isChildrenOpened(t.spanId),isInfoOpened:e.isInfoOpened(t.spanId),onChildrenToggle:e.handleChildrenToggle,onInfoToggle:e.handleInfoToggle})}))}}]),t}(r.a.Component),Le=a(25),xe=a.n(Le);function Re(e){if(e.length>16){var t=e.padStart(32,"0");return t.startsWith("0000000000000000")?t.substring(16):t}return e.padStart(16,"0")}function De(e){return e&&Object.keys(e).length>0}function Ae(e,t){var a={traceId:t.traceId.length>16?t.traceId:e.traceId},n=e.parentId||t.parentId;n&&(a.parentId=n),a.id=e.id;var r=e.name||t.name;r&&(a.name=r);var i=e.kind||t.kind;i&&(a.kind=i);var s=e.timestamp||t.timestamp;s&&(a.timestamp=s);var c=e.duration||t.duration;c&&(a.duration=c);var o=Object.assign({},e.localEndpoint,t.localEndpoint);De(o)&&(a.localEndpoint=o);var l=Object.assign({},e.remoteEndpoint,t.remoteEndpoint);return De(l)&&(a.remoteEndpoint=l),0===e.annotations.length?a.annotations=t.annotations:0===t.annotations.length?a.annotations=e.annotations:a.annotations=xe()(xe.a.unionWith(e.annotations,t.annotations,xe.a.isEqual)).sortBy("timestamp","value").value(),a.tags=Object.assign({},e.tags,t.tags),(e.debug||t.debug)&&(a.debug=!0),(e.shared||t.shared)&&(a.shared=!0),a}function Me(e,t){return e||t?e?t?(e>t)-(e<t):1:-1:0}function Ue(e){return"undefined"===typeof e}function Be(e,t){var a=Ue(e.shared)||!e.shared,n=Ue(t.shared)||!t.shared;return a&&n?"CLIENT"===e.kind?-1:1:a?-1:n?1:0}function Pe(e,t){var a=Me(e.id,t.id);if(0!==a)return a;var n=Be(e,t);return 0!==n?n:function(e,t){if(Ue(e))return-1;if(Ue(t))return 1;var a=Me(e.serviceName,t.serviceName);if(0!==a)return a;var n=Me(e.ipv4,t.ipv4);return 0!==n?n:Me(e.ipv6,t.ipv6)}(e.localEndpoint,t.localEndpoint)}function Ve(e,t){return!e.parentId&&t.parentId?-1:e.parentId&&!t.parentId?1:e.id===t.id?Be(e,t):Me(e.timestamp,t.timestamp)||Me(e.name,t.name)}function He(e){var t=e.length;if(0===t)return e;var a,n,r,i,s=[];if(e.forEach(function(e){var t=function(e){var t={traceId:Re(e.traceId)},a=e.id.padStart(16,"0");if(e.parentId){var n=e.parentId.padStart(16,"0");n!==a&&(t.parentId=n)}return t.id=a,e.name&&""!==e.name&&"unknown"!==e.name&&(t.name=e.name),e.kind&&(t.kind=e.kind),e.timestamp&&(t.timestamp=e.timestamp),e.duration&&(t.duration=e.duration),De(e.localEndpoint)&&(t.localEndpoint=Object.assign({},e.localEndpoint)),De(e.remoteEndpoint)&&(t.remoteEndpoint=Object.assign({},e.remoteEndpoint)),t.annotations=e.annotations?e.annotations.slice(0):[],t.annotations.length>1&&(t.annotations=xe()(xe.a.unionWith(t.annotations,xe.a.isEqual)).sortBy("timestamp","value").value()),t.tags=e.tags||{},e.debug&&(t.debug=!0),e.shared&&"CLIENT"!==e.kind&&(t.shared=!0),t}(e);a&&32===a.length||(a=t.traceId),s.push(t)}),t<=1)return s;s.sort(Pe);for(var c=0;c<t;c+=1){var o=s[c];o.traceId.length!==a.length&&(o.traceId=a);for(var l=o.localEndpoint?Object.assign({},o.localEndpoint):{};c+1<t;){var u=s[c+1];if(u.id!==o.id)break;if(o.shared!==u.shared||(r=l,(i=u.localEndpoint)&&(r.serviceName&&i.serviceName&&r.serviceName!==i.serviceName||r.ipv4&&i.ipv4&&r.ipv4!==i.ipv4||r.ipv6&&i.ipv6&&r.ipv6!==i.ipv6||r.port&&i.port&&r.port!==i.port||(r.serviceName||(r.serviceName=i.serviceName),r.ipv4||(r.ipv4=i.ipv4),r.ipv6||(r.ipv6=i.ipv6),r.port||(r.port=i.portAsInt),0))))break;o=Ae(o,u),t-=1,s.splice(c+1,1)}n&&n.id===o.id&&("CLIENT"!==n.kind||"SERVER"!==o.kind||o.shared||(o.shared=!0),o.shared&&!o.parentId&&n.parentId&&(o.parentId=n.parentId)),n=o,s[c]=o}return s.sort(Ve)}var Ke=function(){function e(t){Object(d.a)(this,e),this._parent=void 0,this._span=t,this._children=[]}return Object(h.a)(e,[{key:"_setParent",value:function(e){this._parent=e}},{key:"setSpan",value:function(e){if(!e)throw new Error("span was undefined");this._span=e}},{key:"addChild",value:function(e){if(!e)throw new Error("child was undefined");if(e===this)throw new Error("circular dependency on ".concat(this.toString()));e._setParent(this),this._children.push(e)}},{key:"queueRootMostSpans",value:function(){var e=[];if("undefined"===typeof this.span?this.children.forEach(function(t){return e.push(t)}):e.push(this),0===e.length)throw new Error("Trace was empty");return e}},{key:"traverse",value:function(e){for(var t=this.queueRootMostSpans();t.length>0;){var a=t.shift();e(a.span);for(var n=a.children,r=0;r<n.length;r+=1)t.push(n[r])}}},{key:"toString",value:function(){return this._span?"SpanNode(".concat(JSON.stringify(this._span),")"):"SpanNode()"}},{key:"parent",get:function(){return this._parent}},{key:"span",get:function(){return this._span}},{key:"children",get:function(){return this._children}}]),e}();function We(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;if(!t)return e;var n=a?JSON.stringify(a):"x";return"".concat(e,"-").concat(n)}var ze=function(){function e(t){Object(d.a)(this,e);var a=t.debug,n=void 0!==a&&a;this._debug=n,this._rootSpan=void 0,this._keyToNode={},this._spanToParent={}}return Object(h.a)(e,[{key:"_index",value:function(e){var t,a;e.shared?(t=We(e.id,!0,e.localEndpoint),a=e.id):(t=e.id,a=e.parentId),this._spanToParent[t]=a}},{key:"_process",value:function(e){var t,a=e.localEndpoint,n=We(e.id,e.shared,e.localEndpoint),r=a?We(e.id,e.shared):n;if(e.shared)t=e.id;else if(e.parentId)t=We(e.parentId,!0,a),this._spanToParent[t]?this._spanToParent[r]=t:t=e.parentId;else if(this._rootSpan&&this._debug){console.log("".concat("attributing span missing parent to root",": traceId=").concat(e.traceId,", rootId=").concat(this._rootSpan.span.id,", id=").concat(e.id))}var i=new Ke(e);t||this._rootSpan?e.shared?(this._keyToNode[n]=i,this._keyToNode[r]=i):this._keyToNode[r]=i:(this._rootSpan=i,delete this._spanToParent[r])}},{key:"build",value:function(e){var t=this;if(0===e.length)throw new Error("Trace was empty");var a=He(e),n=a.length,r=Object(ge.a)(a,1)[0].traceId;this._debug&&console.log("building trace tree: traceId=".concat(r));for(var i=0;i<n;i+=1)this._index(a[i]);for(var s=0;s<n;s+=1)this._process(a[s]);return this._rootSpan||(this._debug&&console.log("substituting dummy node for missing root span: traceId=".concat(r)),this._rootSpan=new Ke),Object.keys(this._spanToParent).forEach(function(e){var a=t._keyToNode[e],n=t._keyToNode[t._spanToParent[e]];n?n.addChild(a):t._rootSpan.addChild(a)}),this._rootSpan}}]),e}(),Qe=function(){function e(t){Object(d.a)(this,e);var a=t.endpoint,n=t.skew;this._endpoint=a,this._skew=n}return Object(h.a)(e,[{key:"endpoint",get:function(){return this._endpoint}},{key:"skew",get:function(){return this._skew}}]),e}();function Ge(e,t){return!(!e||!t)&&(!(!e.ipv6||!t.ipv6||e.ipv6!==t.ipv6)||!(!e.ipv4&&!t.ipv4)&&e.ipv4===t.ipv4)}function Ye(e,t){if(!Ge(t.endpoint,e.localEndpoint))return e;var a=Object.assign({},e);e.timestamp&&(a.timestamp=e.timestamp-t.skew);var n=e.annotations.length;n>0&&(a.annotations=[]);for(var r=0;r<n;r+=1){var i=e.annotations[r];a.annotations[r]={timestamp:i.timestamp-t.skew,value:i.value}}return a}function Xe(e,t){t&&e.setSpan(Ye(e.span,t));var a=function(e){var t=e.parent?e.parent.span:void 0,a=e.span;if(t&&"CLIENT"===t.kind&&"SERVER"===a.kind){var n=!1,r=t.timestamp,i=a.timestamp;if(r&&i&&!(i>r)){var s=t.duration,c=a.duration;s&&c||(n=!0);var o=a.localEndpoint;if(o){var l=t.localEndpoint;if(l&&!Ge(o,l)){if(n){var u=i-r;if(u>0)return;return new Qe({endpoint:o,skew:u-1})}if(s<c)return new Qe({endpoint:o,skew:i-r-1});var d=(s-c)/2;if(!(d<0)){var h=i-d-r;return 0!==h?new Qe({endpoint:o,skew:h}):void 0}}}}}}(e);a?e.setSpan(Ye(e.span,a)):t&&(a=t),e.children.forEach(function(e){return Xe(e,a)})}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.length)return new Ke;var a=new ze({debug:t}).build(e);if(!a.span)return t&&console.log("skipping clock skew adjustment due to missing root span: traceId=".concat(e[0].traceId)),a;for(var n=a.children,r=0;r<n.length;r+=1){var i=n[r].span;if(!i.parentId&&!i.shared){var s=i.traceId,c=i.id,o=a.span.id;if(t){console.log("".concat("skipping redundant root span",": traceId=").concat(s,", rootSpanId=").concat(o,", spanId=").concat(c))}return a}}return Xe(a),a}var Je={};function Ze(e,t){return"critical"===t?t:void 0!==e.tags.error?"critical":-1!==e.annotations.findIndex(function(e){return"error"===e.value})?"transient":t}function $e(e){if(e){var t=e.ipv4,a=e.ipv6,n=e.port,r=e.serviceName;return t||a?(a?"[".concat(a,"]"):t)+(n?":".concat(n):"")+(r?" (".concat(r,")"):""):r||""}}function et(e,t){var a={isDerived:arguments.length>2&&void 0!==arguments[2]&&arguments[2],value:Je[e.value]||e.value,timestamp:e.timestamp};return t&&(a.endpoint=t),a}function tt(e,t){t&&-1===e.findIndex(function(e){return e===t})&&e.push(t)}function at(e){return e?e.serviceName:void 0}function nt(e){var t,a,n={spanId:Object(ge.a)(e,1)[0].id,serviceNames:[],annotations:[],tags:[],errorType:"none"};return e.forEach(function(e){e.parentId&&(n.parentId=e.parentId),!e.name||n.spanName&&"SERVER"!==e.kind||(n.spanName=e.name),e.shared?(t||(t=e.timestamp),a||(a=e.duration)):(!n.timestamp&&e.timestamp&&(n.timestamp=e.timestamp),!n.duration&&e.duration&&(n.duration=e.duration));var r=at(e.localEndpoint);!r||n.serviceName&&"SERVER"!==e.kind||(n.serviceName=r),tt(n.serviceNames,r),tt(n.serviceNames,at(e.remoteEndpoint)),function(e){var t,a,n=$e(e.localEndpoint)||void 0,r=e.timestamp||0,i=r&&e.duration?r+e.duration:0,s=0,c=0,o=0,l=0,u=e.kind,d=[];switch(e.annotations.forEach(function(e){switch(e.value){case"cs":u="CLIENT",e.timestamp<=r?r=e.timestamp:d.push(e);break;case"sr":u="SERVER",e.timestamp<=r?r=e.timestamp:d.push(e);break;case"ss":u="SERVER",e.timestamp>=i?i=e.timestamp:d.push(e);break;case"cr":u="CLIENT",e.timestamp>=i?i=e.timestamp:d.push(e);break;case"ms":u="PRODUCER",s=e.timestamp;break;case"mr":u="CONSUMER",l=e.timestamp;break;case"ws":c=e.timestamp;break;case"wr":o=e.timestamp;break;default:d.push(e)}}),u){case"CLIENT":t="Client Start",a="Client Finish";break;case"SERVER":t="Server Start",a="Server Finish";break;case"PRODUCER":t="Producer Start",a="Producer Finish",(0===r||0!==s&&s<r)&&(r=s,s=0),(0===i||0!==c&&c>i)&&(i=c,c=0);break;case"CONSUMER":(0===r||0!==o&&o<r)&&(r=o,o=0),(0===i||0!==l&&l>i)&&(i=l,l=0),0!==i||0!==o?(t="Consumer Start",a="Consumer Finish"):t="Consumer Start"}s&&d.push({timestamp:s,value:"ms"}),c&&d.push({timestamp:c,value:"ws"}),o&&d.push({timestamp:o,value:"wr"}),l&&d.push({timestamp:l,value:"mr"});var h=r&&t,m=i&&a,p=[];return h&&p.push(et({value:t,timestamp:r},n,!0)),d.forEach(function(e){h&&e.value===t||m&&e.value===a||p.push(et(e,n))}),m&&p.push(et({value:a,timestamp:i},n,!0)),p}(e).forEach(function(e){return function(e,t){-1===e.findIndex(function(e){return t.value===e.value})&&e.push(t)}(n.annotations,e)}),function(e){var t,a=$e(e.localEndpoint)||void 0,n=[],r=Object.keys(e.tags);switch(r.length>0&&r.forEach(function(t){var r={key:Je[t]||t,value:e.tags[t]};a&&(r.endpoint=a),n.push(r)}),!e.kind&&0===e.annotations.length&&a&&0===r.length&&n.push({key:"Local Address",value:a}),e.kind){case"CLIENT":t="Server Address";break;case"SERVER":t="Client Address";break;case"PRODUCER":case"CONSUMER":t="Broker Address"}return e.remoteEndpoint&&n.push({key:t||"Server Address",value:$e(e.remoteEndpoint)}),n}(e).forEach(function(e){return t=n.tags,a=e,void(-1===t.findIndex(function(e){return a.key===e.key})&&t.push(a));var t,a}),n.errorType=Ze(e,n.errorType),e.debug&&(n.debug=!0)}),!n.timestamp&&t&&(n.timestamp=t),!n.duration&&a&&(n.duration=a),n.serviceNames.sort(),n.annotations.sort(function(e,t){return e.timestamp-t.timestamp}),n}function rt(e,t){e.timestamp&&(t.push(e.timestamp),e.duration&&t.push(e.timestamp+e.duration))}function it(e){return e.length>1?(e.sort(),e[e.length-1]-e[0]):0}function st(e,t,a){e[t]?e[t].push(a):e[t]=[a]}function ct(e){var t,a=[],n={},r=0,i="none";if(e.traverse(function(e){r+=1,t=e.traceId,i=Ze(e,i),rt(e,a),function(e,t){var a={timestamp:e.timestamp||0,duration:e.duration||0};e.localEndpoint&&e.localEndpoint.serviceName&&st(t,e.localEndpoint.serviceName,a),e.remoteEndpoint&&e.remoteEndpoint.serviceName&&st(t,e.remoteEndpoint.serviceName,a)}(e,n)}),0===a.length)throw new Error("Trace ".concat(t," is missing a timestamp"));return{traceId:t,timestamp:a[0],duration:it(a),groupedTimestamps:n,errorType:i,spanCount:r}}function ot(e,t){var a=y()(e/1e3);return t&&(a=a.utc()),a.format("MM-DD-YYYYTHH:mm:ss.SSSZZ")}function lt(e){return 0===e||"undefined"===typeof e?"":e<1e3?"".concat(e.toFixed(0),"\u03bcs"):e<1e6?"".concat((e/1e3).toFixed(e%1e3===0?0:3),"ms"):"".concat((e/1e6).toFixed(3),"s")}function ut(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Math.max.apply(Math,Object(W.a)(t.map(function(e){return e.duration})));return t.map(function(t){var r,i=t.timestamp,s={traceId:t.traceId,timestamp:i,startTs:ot(i,a),spanCount:t.spanCount},c=t.duration||0;if(c&&(s.width=parseInt(parseFloat(c)/parseFloat(n)*100,10),s.duration=c/1e3,s.durationStr=lt(c)),0!==Object.keys(t.groupedTimestamps).length&&(s.serviceSummaries=(r=t.groupedTimestamps,xe()(r).toPairs().map(function(e){var t=Object(ge.a)(e,2),a=t[0],n=t[1];return{serviceName:a,spanCount:n.length,maxSpanDuration:Math.max.apply(Math,Object(W.a)(n.map(function(e){return e.duration})))}}).orderBy(["maxSpanDuration","serviceName"],["desc","asc"]).map(function(e){return{serviceName:e.serviceName,spanCount:e.spanCount,maxSpanDurationStr:lt(e.maxSpanDuration)}}).value()),e&&c&&t.groupedTimestamps[e])){var o=function(e){var t=xe()(e).filter(function(e){return e.duration}).sortBy("timestamp").value();if(0===t.length)return 0;if(1===t.length)return t[0].duration;for(var a=t[0].duration,n=t[0].timestamp+t[0].duration,r=1;r<t.length;r+=1){var i=t[r],s=i.timestamp+i.duration;s<=n||(i.timestamp<=n?(a+=s-n,n=s):(a+=i.duration,n=s))}return a}(t.groupedTimestamps[e]);s.servicePercentage=parseInt(parseFloat(o)/parseFloat(c)*100,10)}return"none"!==t.errorType&&(s.infoClass="trace-error-".concat(t.errorType)),s}).sort(function(e,t){var a=t.duration-e.duration;return 0===a?e.traceId.localeCompare(t.traceId):a})}function dt(e,t){var a={},n=e.queueRootMostSpans(),r={traceId:n[0].span.traceId,depth:0,spans:[]},i=function(e){var t=[];return e.traverse(function(e){return rt(e,t)}),{timestamp:t[0]||0,duration:it(t)}}(e),s=i.timestamp,c=i.duration;if(!s)throw new Error("Trace ".concat(r.traceId," is missing a timestamp"));for(var o=function(){var e=n.shift(),t=[e.span],i=[],o=[];e.children.forEach(function(a){e.span.id===a.span.id?(t.push(a.span),a.children.forEach(function(e){o.push(e),i.push(e.span.id)})):(o.push(a),i.push(a.span.id))}),n=o.concat(n);for(var l=1;e.parent&&e.parent.span;)e.parent.span.id!==e.span.id&&(l+=1),e=e.parent;l>r.depth&&(r.depth=l);var u=nt(t);!function(e,t,a,n,r){if(e.childIds=r,e.depth=n+1,e.depthClass=(n-1)%6,e.duration){var i=a?e.duration/a*100:0;e.width=i<.1?.1:i,e.durationStr=lt(e.duration)}else e.width=.1;a?(e.left=(e.timestamp-t)/a*100,e.annotations.forEach(function(a){a.left=e.duration?(a.timestamp-e.timestamp)/e.duration*100:0,a.relativeTime=lt(a.timestamp-t),a.width=8})):e.left=0}(u,s,c,l,i),u.serviceNames.forEach(function(e){var t,n;(t=a)[n=e]?t[n]+=1:t[n]=1}),r.spans.push(u)};n.length>0;)o();return r.serviceNameAndSpanCounts=Object.keys(a).sort().map(function(e){return{serviceName:e,spanCount:a[e]}}),r.spansBackup=r.spans,r.timeMarkers=[0,.2,.4,.6,.8,1].map(function(e,t){return{index:t,time:lt(c*e)}}),r.timeMarkersBackup=r.timeMarkers,r.duration=c,c&&(r.durationStr=lt(c)),t&&(r.logsUrl=t),r}Je.cs="Client Send",Je.csf="Client Send Fragment",Je.cr="Client Receive",Je.crf="Client Receive Fragment",Je.ms="Producer Send",Je.mr="Consumer Receive",Je.ss="Server Send",Je.ssf="Server Send Fragment",Je.sr="Server Receive",Je.srf="Server Receive Fragment",Je.ca="Client Address",Je.ma="Broker Address",Je.sa="Server Address",Je.ws="Wire Send",Je.wr="Wire Receive",Je.lc="Local Component";var ht={infoClass:"none",servicePercentage:void 0},mt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isTimelineOpened:!1},a.handleTimelineOpenToggle=a.handleTimelineOpenToggle.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleTimelineOpenToggle",value:function(){var e=this.state.isTimelineOpened;this.setState({isTimelineOpened:!e})}},{key:"barColor",value:function(){switch(this.props.infoClass){case"trace-error-transient":return _e("transient");case"trace-error-critical":return _e("critical");default:return _e("none")}}},{key:"renderBar",value:function(e,t){return r.a.createElement("div",{className:"trace-summary__bar-container",role:"presentation",onClick:this.handleTimelineOpenToggle},r.a.createElement("div",{className:"trace-summary__bar-wrapper",style:{width:"".concat(e,"%")}},r.a.createElement("div",{className:"trace-summary__bar",style:{backgroundColor:this.barColor()}})),r.a.createElement("div",{className:"trace-summary__bar-label"},t))}},{key:"renderButtons",value:function(){var e=this.props.traceId,t=this.state.isTimelineOpened;return r.a.createElement("div",{className:"trace-summary__buttons"},r.a.createElement("span",{className:"fas fa-angle-double-".concat(t?"up":"down"," trace-summary__button"),role:"presentation",onClick:this.handleTimelineOpenToggle}),r.a.createElement("a",{href:"".concat(ce,"/").concat(e),target:"_brank"},r.a.createElement("i",{className:"fas fa-file-download"})),r.a.createElement(f.a,{to:{pathname:"/zipkin/trace/".concat(e)}},r.a.createElement("i",{className:"fas fa-angle-double-right"})))}},{key:"renderServiceBadges",value:function(){return this.props.serviceSummaries.map(function(e){return r.a.createElement("div",{key:e.serviceName,className:"trace-summary__badge-wrapper"},r.a.createElement(Se,{serviceName:e.serviceName,count:e.spanCount}))})}},{key:"renderTimeline",value:function(){var e=this.props.skewCorrectedTrace;if(!this.state.isTimelineOpened)return null;var t=dt(e);return r.a.createElement("div",{className:"trace-summary__timeline-wrapper"},r.a.createElement(Ie,{startTs:0,endTs:t.duration,traceSummary:t}))}},{key:"render",value:function(){var e=this.props,t=e.traceId,a=e.width,n=e.servicePercentage,i=e.spanCount,s=e.durationStr,c=e.timestamp,o=r.a.createElement("div",{className:"trace-summary__upper-bar-label"},r.a.createElement("div",null,"".concat(i,"spans ").concat(s)),r.a.createElement("div",null,y()(c/1e3).format("MM/DD HH:mm:ss:SSS"))),l="".concat(n,"%");return r.a.createElement("div",{className:"trace-summary"},r.a.createElement("div",{className:"trace-summary__trace-id"},"Trace ID:\xa0",r.a.createElement("b",null,t)),r.a.createElement("div",{className:"trace-summary__upper-container"},r.a.createElement("div",{className:"trace-summary__bars"},this.renderBar(a,o),n?this.renderBar(n,l):null),this.renderButtons()),r.a.createElement("div",{className:"trace-summary__lower-container"},this.renderServiceBadges()),this.renderTimeline())}}]),t}(r.a.Component);mt.defaultProps=ht;var pt=mt,vt=a(50),ft=function(e){var t=e.active;return r.a.createElement("div",null,r.a.createElement(vt.CSSTransition,{in:t,className:"loading-overlay",classNames:"loading-overlay",timeout:100,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement("div",null,t?r.a.createElement("i",{className:"fa fa-spinner fa-spin loading-overlay-icon"}):null)))},bt=[{value:"LONGEST",label:"Longest First"},{value:"SHORTEST",label:"Shortest First"},{value:"NEWEST",label:"Newest First"},{value:"OLDEST",label:"Oldest First"}],Et=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={sortingMethod:"LONGEST"},a.handleSortingMethodChange=a.handleSortingMethodChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentWillUnmount",value:function(){(0,this.props.clearTraces)()}},{key:"handleSortingMethodChange",value:function(e){this.setState({sortingMethod:e.value})}},{key:"sortTraceSummaries",value:function(){var e=this.props.traceSummaries,t=this.state.sortingMethod;return e.sort(function(e,a){switch(t){case"LONGEST":return a.duration-e.duration;case"SHORTEST":return e.duration-a.duration;case"NEWEST":return a.timestamp-e.timestamp;case"OLDEST":return e.timestamp-a.timestamp;default:return 0}})}},{key:"renderResultsHeader",value:function(){var e=this.props.traceSummaries,t=this.state.sortingMethod;return r.a.createElement("div",{className:"browser__results-header"},r.a.createElement("div",{className:"browser__total-results"},"".concat(e.length," results")),r.a.createElement("div",null,r.a.createElement(S.a,{onChange:this.handleSortingMethodChange,className:"browser__sorting-method-select",options:bt,value:{value:t,label:bt.find(function(e){return e.value===t}).label}})))}},{key:"renderResults",value:function(){var e=this.props.skewCorrectedTracesMap,t=this.sortTraceSummaries();return r.a.createElement("div",{className:"browser__results"},t.map(function(t){return r.a.createElement("div",{key:t.traceId,className:"browser__trace-summary-wrapper"},r.a.createElement(pt,{traceId:t.traceId,width:t.width,infoClass:t.infoClass,spanCount:t.spanCount,durationStr:t.durationStr,timestamp:t.timestamp,servicePercentage:t.servicePercentage,serviceSummaries:t.serviceSummaries,skewCorrectedTrace:e[t.traceId]}))}))}},{key:"render",value:function(){var e=this.props.isLoading;return r.a.createElement("div",{className:"browser"},r.a.createElement(ft,{active:e}),this.renderResultsHeader(),this.renderResults())}}]),t}(r.a.Component),gt=Object(c.b)(function(e,t){var a,n=t.location;""!==n.search&&"?"!==n.search&&(a=O.a.parse(n.search).serviceName);var r=e.traces.traces,i=r.map(qe),s=ut(a,i.map(ct)),c={};return i.forEach(function(e,t){var a=Object(ge.a)(r[t],1)[0].traceId;c[a]=e}),{traceSummaries:s,skewCorrectedTracesMap:c,isLoading:e.traces.isLoading}},function(e){return{clearTraces:function(){return e({type:"CLEAR_TRACES"})}}})(Et),Ct=function(e){return{type:"FETCH_TRACE_SUCCESS",trace:e}},kt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isDragging:!1,dragStartX:null,dragCurrentX:null},a._graphElement=void 0,a.setGraphElement=a.setGraphElement.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseDown=a.handleMouseDown.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseMove=a.handleMouseMove.bind(Object(C.a)(Object(C.a)(a))),a.handleMouseUp=a.handleMouseUp.bind(Object(C.a)(Object(C.a)(a))),a.handleDoubleClick=a.handleDoubleClick.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"setGraphElement",value:function(e){this._graphElement=e}},{key:"getPosition",value:function(e){var t=this._graphElement.getBoundingClientRect();return(e-t.left)/t.width}},{key:"handleMouseDown",value:function(e){if(0===e.button){var t=this.getPosition(e.clientX);this.setState({isDragging:!0,dragStartX:t,dragCurrentX:t}),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}}},{key:"handleMouseMove",value:function(e){this.setState({dragCurrentX:this.getPosition(e.clientX)})}},{key:"handleMouseUp",value:function(e){var t,a,n=this.props,r=n.traceSummary,i=n.onStartAndEndTsChange,s=this.state.dragStartX;this.setState({isDragging:!1});var c=this.getPosition(e.clientX);c>s?(t=Math.max(s*r.duration,0),a=Math.min(c*r.duration,r.duration)):(t=Math.max(c*r.duration,0),a=Math.min(s*r.duration,r.duration)),i(t,a),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"handleDoubleClick",value:function(){var e=this.props,t=e.traceSummary;(0,e.onStartAndEndTsChange)(0,t.duration)}},{key:"renderTicks",value:function(){for(var e=this.props.traceSummary,t=[],a=0;a<5;a+=1){var n=Ce(a/4*e.duration),i=a/4,s="";0===i?s="first":i>=1&&(s="last"),t.push(r.a.createElement("div",{key:i,className:"mini-trace-viewer__time-marker",style:{left:"".concat(100*i,"%")}},r.a.createElement("span",{className:"mini-trace-viewer__time-marker-label ".concat(s)},n)))}return r.a.createElement("div",null,t)}},{key:"render",value:function(){var e=this.props,t=e.traceSummary,a=e.startTs,n=e.endTs,i=this.state,s=i.isDragging,c=i.dragStartX,o=i.dragCurrentX,l=t.spans,u=75/l.length;return r.a.createElement("div",{className:"mini-trace-viewer"},r.a.createElement("div",{className:"mini-trace-viewer__time-markers-wrapper"},this.renderTicks()),r.a.createElement("div",{className:"mini-trace-viewer__graph",ref:this.setGraphElement,role:"presentation",onMouseDown:this.handleMouseDown,onDoubleClick:this.handleDoubleClick},r.a.createElement("svg",{version:"1.1",width:"100%",height:75,xmlns:"http://www.w3.org/2000/svg"},function(){for(var e=[],t=1;t<4;t+=1){var a=25*t;e.push(r.a.createElement("line",{key:a,x1:"".concat(a,"%"),x2:"".concat(a,"%"),y1:"0",y2:75}))}return r.a.createElement("g",{stroke:"#888",strokeWidth:"1"},e)}(),l.map(function(e,t){return r.a.createElement("rect",{key:e.spanId,width:"".concat(e.width,"%"),height:u,x:"".concat(e.left,"%"),y:t*u,fill:Oe(e.serviceName)})}),s?r.a.createElement("g",{stroke:"#999",strokeWidth:"1"},r.a.createElement("line",{x1:"".concat(100*c,"%"),x2:"".concat(100*c,"%"),y1:0,y2:75}),r.a.createElement("line",{x1:"".concat(100*c,"%"),x2:"".concat(100*o,"%"),y1:37.5,y2:37.5}),r.a.createElement("line",{x1:"".concat(100*o,"%"),x2:"".concat(100*o,"%"),y1:0,y2:75})):null,a?r.a.createElement("rect",{width:"".concat(a/t.duration*100,"%"),height:75,x:"0",y:"0",fill:"rgba(50, 50, 50, 0.2)"}):null,n?r.a.createElement("rect",{width:"".concat((t.duration-n)/t.duration*100,"%"),height:75,x:"".concat(n/t.duration*100,"%"),y:"0",fill:"rgba(50, 50, 50, 0.2)"}):null)))}}]),t}(r.a.Component),yt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={startTs:null,endTs:null},a.handleStartAndEndTsChange=a.handleStartAndEndTsChange.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchTrace,a=e.traceId,n=e.traceSummary;n&&n.traceId===a||t(a)}},{key:"handleStartAndEndTsChange",value:function(e,t){this.setState({startTs:e,endTs:t})}},{key:"renderHeader",value:function(){var e=this.props,t=e.traceId,a=e.traceSummary,n=a.durationStr,i=a.serviceNameAndSpanCounts,s=a.spans,c=a.depth;return r.a.createElement("div",{className:"detailed-trace-summary__header"},r.a.createElement("div",{className:"detailed-trace-summary__trace-id"},t),r.a.createElement("div",{className:"detailed-trace-summary__trace-data-list"},[{label:"Duration",value:n},{label:"Services",value:i.length},{label:"Depth",value:c},{label:"Total Spans",value:s.length}].map(function(e){return r.a.createElement("div",{key:e.label,className:"detailed-trace-summary__data-wrapper"},r.a.createElement("div",{className:"detailed-trace-summary__data-label"},e.label),r.a.createElement("div",{className:"detailed-trace-summary__data-value"},e.value))})))}},{key:"render",value:function(){var e=this.state,t=e.startTs,a=e.endTs,n=this.props,i=n.isLoading,s=n.traceId,c=n.traceSummary;return r.a.createElement("div",null,r.a.createElement(ft,{active:i}),r.a.createElement("div",{className:"detailed-trace-summary"},c&&c.traceId===s?r.a.createElement("div",null,this.renderHeader(),r.a.createElement("div",{className:"detailed-trace-summary__mini-trace-viewer-wrapper"},r.a.createElement(kt,{startTs:t||0,endTs:a||c.duration,traceSummary:c,onStartAndEndTsChange:this.handleStartAndEndTsChange})),r.a.createElement("div",{className:"detailed-trace-summary__timeline-wrapper"},r.a.createElement(Ie,{startTs:t||0,endTs:a||c.duration,traceSummary:c}))):null))}}]),t}(r.a.Component);yt.defaultProps={traceSummary:null};var _t=yt,Ot=Object(c.b)(function(e,t){var a={isLoading:e.trace.isLoading,traceId:t.match.params.traceId};if(0===e.trace.trace.length)a.traceSummary=null;else{var n=qe(e.trace.trace);a.traceSummary=dt(n)}return a},function(e){return{fetchTrace:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark(function t(a){var n,r;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"FETCH_TRACE_REQUEST"}),t.prev=1,t.next=4,Promise.all([fetch("".concat(ce,"/").concat(e)),new Promise(function(e){return setTimeout(e,300)})]);case 4:if((n=t.sent)[0].ok){t.next=7;break}throw Error(n[0].statusText);case 7:return t.next=9,n[0].json();case 9:r=t.sent,a(Ct(r)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),a({type:"FETCH_TRACE_FAILURE"});case 16:case"end":return t.stop()}},t,this,[[1,13]])}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(_t),Nt=a(156),St=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentWillUnmount",value:function(){this.vizceral.animate=function(){},delete this.vizceral}}]),t}(a.n(Nt).a),Tt={selectedServiceName:void 0},jt={colorText:"rgb(50, 50, 50)",colorTextDisabled:"rgb(50, 50, 50)",colorConnectionLine:"rgb(50, 50, 50)",colorTraffic:{normal:"rgb(145, 200, 220)",warning:"rgb(255, 75, 75)",danger:"rgb(255, 75, 75)"},colorDonutInternalColor:"rgb(245, 245, 245)",colorDonutInternalColorHighlighted:"rgb(145, 200, 220)",colorLabelBorder:"rgb(85, 140, 160)",colorLabelText:"rgb(50, 50, 50)",colorTrafficHighlighted:{normal:"rgb(155, 210, 230)"}},wt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleObjectHighlighted=a.handleObjectHighlighted.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleObjectHighlighted",value:function(e){var t=this.props,a=t.selectedServiceName,n=t.onServiceSelect;"undefined"!==typeof e?"node"===e.type&&e.getName()!==a&&n(e.getName()):n(void 0)}},{key:"render",value:function(){var e=this.props,t=e.graph,a=e.filter,n=0;if(t.allEdges().length>0){var i=xe.a.maxBy(t.allEdges(),function(e){return e.metrics.normal+e.metrics.danger});n=i.metrics.normal+i.metrics.danger}return r.a.createElement("div",{className:"dependencies__graph"},r.a.createElement(St,{allowDraggingOfNodes:!0,targetFramerate:15,traffic:{renderer:"region",layout:"ltrTree",name:"dependencies-graph",updated:(new Date).getTime(),maxVolume:2e3*n,nodes:t.allNodes(),connections:t.allEdges()},objectHighlighted:this.handleObjectHighlighted,match:a,styles:jt}))}}]),t}(r.a.Component);wt.defaultProps=Tt;var Ft=wt,It=a(157),Lt=function(e,t){if(0===e.length)return r.a.createElement("div",{className:"dependencies-sidebar__no-edges"},r.a.createElement("span",{className:"fas fa-exclamation-circle dependencies-sidebar__no-edges-icon"}),"No services");var a=t?"target":"source";return e.map(function(e){return r.a.createElement("div",{className:"dependencies-sidebar__edge-data"},r.a.createElement(Se,{serviceName:e[a]}),r.a.createElement("div",{className:"dependencies-sidebar__count-data-wrapper"},r.a.createElement("div",{className:"dependencies-sidebar__count-data"},r.a.createElement("div",{className:"dependencies-sidebar__count-data-label dependencies-sidebar__count-data-label--normal"},"COUNT"),r.a.createElement("div",{className:"dependencies-sidebar__count-data-value"},e.metrics.normal)),r.a.createElement("div",{className:"dependencies-sidebar__count-data"},r.a.createElement("div",{className:"dependencies-sidebar__count-data-label dependencies-sidebar__count-data-label--danger"},"ERROR"),r.a.createElement("div",{className:"dependencies-sidebar__count-data-value"},e.metrics.danger))))})},xt=function(e,t){if(0===e.length)return null;var a={maintainAspectRatio:!1,responsive:!1,labels:t?e.map(function(e){return e.target}):e.map(function(e){return e.source}),datasets:[{data:e.map(function(e){return e.metrics.normal+e.metrics.danger}),backgroundColor:t?e.map(function(e){return Oe(e.target)}):e.map(function(e){return Oe(e.source)})}]};return r.a.createElement("div",{className:"dependencies-sidebar__doughnut"},r.a.createElement(It.a,{data:a,width:420,height:540}))},Rt=function(e){var t=e.serviceName,a=e.targetEdges,n=e.sourceEdges;return r.a.createElement("div",{className:"dependencies-sidebar"},r.a.createElement("div",{className:"dependencies-sidebar__service-name-container"},r.a.createElement("div",{className:"dependencies-sidebar__service-name"},t)),r.a.createElement("div",{className:"dependencies-sidebar__subtitle"},r.a.createElement("span",{className:"fas fa-angle-double-down dependencies-sidebar__subtitle-icon"}),r.a.createElement("strong",null,"Uses"),"(Traced requests)"),Lt(a,!0),r.a.createElement("div",{className:"dependencies-sidebar__doughnut-wrapper"},xt(a,!0)),r.a.createElement("div",{className:"dependencies-sidebar__separator"}),r.a.createElement("div",{className:"dependencies-sidebar__subtitle"},r.a.createElement("span",{className:"fas fa-angle-double-up dependencies-sidebar__subtitle-icon"}),r.a.createElement("strong",null,"Used by"),"(Traced requests)"),Lt(n,!1),r.a.createElement("div",{className:"dependencies-sidebar__doughnut-wrapper"},xt(n,!1)))},Dt=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={startTs:y()().subtract(1,"days"),endTs:y()(),selectedServiceName:"",filter:""},a.handleStartTsChange=a.handleStartTsChange.bind(Object(C.a)(Object(C.a)(a))),a.handleEndTsChange=a.handleEndTsChange.bind(Object(C.a)(Object(C.a)(a))),a.handleServiceSelect=a.handleServiceSelect.bind(Object(C.a)(Object(C.a)(a))),a.handleFilterChange=a.handleFilterChange.bind(Object(C.a)(Object(C.a)(a))),a.handleAnalyzeButtonClick=a.handleAnalyzeButtonClick.bind(Object(C.a)(Object(C.a)(a))),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location,a=e.fetchDependencies,n=O.a.parse(t.search),r=n.endTs?y()(parseInt(n.endTs,10)):y()(),i=n.lookback?y.a.duration(parseInt(n.lookback,10)):y.a.duration(1,"days"),s=r.clone().subtract(i);(this.setState({startTs:s,endTs:r}),""!==t.search&&"?"!==t.search)&&a(O.a.parse(t.search))}},{key:"componentWillReceiveProps",value:function(e){var t=e.location,a=this.props,n=a.location,r=a.fetchDependencies;""!==t.search&&"?"!==t.search&&n.search!==t.search&&r(O.a.parse(t.search))}},{key:"componentWillUnmount",value:function(){(0,this.props.clearDependencies)()}},{key:"handleStartTsChange",value:function(e){this.setState({startTs:e})}},{key:"handleEndTsChange",value:function(e){this.setState({endTs:e})}},{key:"handleServiceSelect",value:function(e){this.setState({selectedServiceName:e})}},{key:"handleFilterChange",value:function(e){this.setState({filter:e})}},{key:"handleAnalyzeButtonClick",value:function(){var e=this.state,t=e.startTs,a=e.endTs,n=this.props.history,r=z({endTs:a.valueOf(),lookback:a.valueOf()-t.valueOf()});n.push({pathname:"/zipkin/dependencies",search:r})}},{key:"renderSearch",value:function(){var e=this.state,t=e.startTs,a=e.endTs;return r.a.createElement("div",{className:"dependencies__search"},r.a.createElement("div",{className:"dependencies__lookback-condition"},r.a.createElement(V,{onChange:this.handleStartTsChange,selected:t})),r.a.createElement("div",{className:"dependencies__lookback-condition-separator"},"-"),r.a.createElement("div",{className:"dependencies__lookback-condition"},r.a.createElement(V,{onChange:this.handleEndTsChange,selected:a})),r.a.createElement("div",{className:"dependencies__analyze-button-wrapper"},r.a.createElement("div",{role:"presentation",onClick:this.handleAnalyzeButtonClick,className:"dependencies__analyze-button"},"Analyze Dependencies")))}},{key:"renderFilter",value:function(){var e=this,t=this.state.filter,a=this.props.graph.allNodeNames().map(function(e){return{value:e,label:e}}),n=t?{value:t,label:t}:void 0;return r.a.createElement(S.a,{onChange:function(t){e.handleFilterChange(t.value)},options:a,value:n,styles:{control:function(e){return Object(N.a)({},e,{width:"240px"})}},placeholder:"Filter by ..."})}},{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.graph,n=this.state,i=n.selectedServiceName,s=n.filter,c=!!i;return r.a.createElement("div",{className:"dependencies"},r.a.createElement(ft,{active:t}),r.a.createElement("div",{className:"dependencies__main ".concat(c?"dependencies__main--narrow":"dependencies__main--wide")},r.a.createElement("div",{className:"dependencies__search-wrapper"},this.renderSearch()),0===a.allNodes().length?null:r.a.createElement("div",null,r.a.createElement("div",{className:"dependencies__filter-wrapper"},this.renderFilter()),r.a.createElement("div",{className:"dependencies__graph-wrapper"},r.a.createElement(Ft,{graph:a,onServiceSelect:this.handleServiceSelect,selectedServiceName:i,filter:s})))),r.a.createElement("div",{className:"dependencies__sidebar-wrapper ".concat(c?"dependencies__sidebar-wrapper--opened":"dependencies__sidebar-wrapper--closed")},r.a.createElement(Rt,{serviceName:i,targetEdges:a.getTargetEdges(i),sourceEdges:a.getSourceEdges(i)})))}}]),t}(r.a.Component),At=Object(u.a)(Dt),Mt=function(e){return{type:"FETCH_DEPENDENCIES_SUCCESS",dependencies:e}},Ut=function(){function e(t){var a=this;Object(d.a)(this,e),this.nodes=[],this.edges=[],t.forEach(function(e){return a.addEdge(e)})}return Object(h.a)(e,[{key:"addEdge",value:function(e){this.allNodeNames().includes(e.parent)||this.nodes.push({name:e.parent}),this.allNodeNames().includes(e.child)||this.nodes.push({name:e.child}),this.edges.push({source:e.parent,target:e.child,metrics:{normal:e.callCount||0,danger:e.errorCount||0}})}},{key:"allNodeNames",value:function(){return this.nodes.map(function(e){return e.name})}},{key:"allNodes",value:function(){return this.nodes}},{key:"allEdges",value:function(){return this.edges}},{key:"getTargetEdges",value:function(e){return this.allEdges().filter(function(t){return t.source===e})}},{key:"getSourceEdges",value:function(e){return this.allEdges().filter(function(t){return t.target===e})}}]),e}(),Bt=Object(c.b)(function(e){return{isLoading:e.dependencies.isLoading,graph:new Ut(e.dependencies.dependencies)}},function(e){return{fetchDependencies:function(t){return e(function(e){return function(){var t=Object(te.a)(ee.a.mark(function t(a){var n,r,i;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"FETCH_DEPENDENCIES_REQUEST"}),t.prev=1,n=O.a.stringify(e),t.next=5,Promise.all([fetch("".concat(oe,"?").concat(n)),new Promise(function(e){return setTimeout(e,500)})]);case 5:if((r=t.sent)[0].ok){t.next=8;break}throw Error(r[0].statusText);case 8:return t.next=10,r[0].json();case 10:i=t.sent,a(Mt(i)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),a({type:"FETCH_DEPENDENCIES_FAILURE"});case 17:case"end":return t.stop()}},t,this,[[1,14]])}));return function(e){return t.apply(this,arguments)}}()}(t))},clearDependencies:function(){return e({type:"CLEAR_DEPENDENCIES"})}}})(At),Pt=a(43),Vt=a(159),Ht={isLoading:!1,spans:[]},Kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SPANS_REQUEST":return Object(N.a)({},e,{isLoading:!0,spans:[]});case"FETCH_SPANS_SUCCESS":return Object(N.a)({},e,{isLoading:!1,spans:t.spans});case"FETCH_SPANS_FAILURE":return Object(N.a)({},e,{isLoading:!1,spans:[]});case"CLEAR_SPANS":return Object(N.a)({},e,{spans:[]});default:return e}},Wt={isLoading:!1,trace:[]},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_TRACE_REQUEST":return Object(N.a)({},e,{isLoading:!0,trace:[]});case"FETCH_TRACE_SUCCESS":return Object(N.a)({},e,{isLoading:!1,trace:t.trace});case"FETCH_TRACE_FAILURE":return Object(N.a)({},e,{isLoading:!1,trace:[]});default:return e}},Qt={isLoading:!1,traces:[]},Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_TRACES_REQUEST":return Object(N.a)({},e,{isLoading:!0});case"FETCH_TRACES_SUCCESS":return Object(N.a)({},e,{isLoading:!1,traces:t.traces});case"FETCH_TRACES_FAILURE":return Object(N.a)({},e,{isLoading:!1,traces:[]});case"CLEAR_TRACES":return Object(N.a)({},e,{traces:[]});default:return e}},Yt={isLoading:!1,services:[]},Xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SERVICES_REQUEST":return Object(N.a)({},e,{isLoading:!0,services:[]});case"FETCH_SERVICES_SUCCESS":return Object(N.a)({},e,{isLoading:!1,services:t.services});case"FETCH_SERVICES_FAILURE":return Object(N.a)({},e,{isLoading:!1,services:[]});default:return e}},qt={isLoading:!1,dependencies:[]},Jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_DEPENDENCIES_REQUEST":return Object(N.a)({},e,{isLoading:!0});case"FETCH_DEPENDENCIES_SUCCESS":return Object(N.a)({},e,{isLoading:!1,dependencies:t.dependencies});case"FETCH_DEPENDENCIES_FAILURE":return Object(N.a)({},e,{isLoading:!1,dependencies:[]});case"CLEAR_DEPENDENCIES":return Object(N.a)({},e,{dependencies:[]});default:return e}},Zt=a(160),$t=a.n(Zt),ea={conditions:[],lookbackCondition:{value:"1h",endTs:y()().valueOf()},limitCondition:10},ta=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ea,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GLOBAL_SEARCH_SET_LOOKBACK_CONDITION":return Object(N.a)({},e,{lookbackCondition:t.lookbackCondition});case"GLOBAL_SEARCH_SET_LIMIT_CONDITION":return Object(N.a)({},e,{limitCondition:t.limitCondition});case"GLOBAL_SEARCH_ADD_CONDITION":var a={key:t.condition.key,value:t.condition.value,_id:$t.a.generate()};return Object(N.a)({},e,{conditions:[].concat(Object(W.a)(e.conditions),[a])});case"GLOBAL_SEARCH_DELETE_CONDITION":var n=Object(W.a)(e.conditions);return n.splice(t.index,1),Object(N.a)({},e,{conditions:n});case"GLOBAL_SEARCH_CHANGE_CONDITION_KEY":var r=Object(W.a)(e.conditions),i=Object(N.a)({},r[t.index]);return i.key=t.conditionKey,i.value=X(t.conditionKey),r[t.index]=i,Object(N.a)({},e,{conditions:r});case"GLOBAL_SEARCH_CHANGE_CONDITION_VALUE":var s=Object(W.a)(e.conditions),c=Object(N.a)({},s[t.index]);return c.value=t.conditionValue,s[t.index]=c,Object(N.a)({},e,{conditions:s});default:return e}},aa={isLoading:!1,autocompleteKeys:[]},na=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_AUTOCOMPLETE_KEYS_REQUEST":return Object(N.a)({},e,{isLoading:!0});case"FETCH_AUTOCOMPLETE_KEYS_SUCCESS":return Object(N.a)({},e,{isLoading:!1,autocompleteKeys:t.autocompleteKeys});case"FETCH_AUTOCOMPLETE_KEYS_FAILURE":return Object(N.a)({},e,{isLoading:!1,autocompleteKeys:[]});default:return e}},ra={isLoading:!1,autocompleteValues:[]},ia=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ra,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_AUTOCOMPLETE_VALUES_REQUEST":return Object(N.a)({},e,{isLoading:!0});case"FETCH_AUTOCOMPLETE_VALUES_SUCCESS":return Object(N.a)({},e,{isLoading:!1,autocompleteValues:t.autocompleteValues});case"FETCH_AUTOCOMPLETE_VALUES_FAILURE":return Object(N.a)({},e,{isLoading:!1,autocompleteValues:[]});default:return e}},sa=Object(Pt.c)({spans:Kt,trace:zt,traces:Gt,services:Xt,dependencies:Jt,globalSearch:ta,autocompleteKeys:na,autocompleteValues:ia});var ca=function(){return r.a.createElement(c.a,{store:Object(Pt.d)(sa,Object(Pt.a)(Vt.a))},r.a.createElement(o.a,null,r.a.createElement(Ee,null,r.a.createElement(l.a,{exact:!0,path:"/zipkin",render:function(e){return r.a.createElement(gt,e)}}),r.a.createElement(l.a,{exact:!0,path:"/zipkin/trace/:traceId",render:function(e){return r.a.createElement(Ot,e)}}),r.a.createElement(l.a,{exact:!0,path:"/zipkin/dependencies",render:function(e){return r.a.createElement(Bt,e)}}))))};a(380);s.a.render(r.a.createElement(ca,null),document.getElementById("app"))}},[[164,2,1]]]);
//# sourceMappingURL=main.b355eef6.chunk.js.map